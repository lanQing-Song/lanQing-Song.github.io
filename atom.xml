<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>R_song☛Blog</title>
  
  <subtitle>!!!∑(ﾟДﾟノ)ノ</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2020-11-16T07:45:24.712Z</updated>
  <id>http://yoursite.com/</id>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Promise(class)自定义</title>
    <link href="http://yoursite.com/2020/11/16/2020-11-16-4/"/>
    <id>http://yoursite.com/2020/11/16/2020-11-16-4/</id>
    <published>2020-11-16T07:44:29.624Z</published>
    <updated>2020-11-16T07:45:24.712Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="promiseclass版自定义"><a class="anchor" href="#promiseclass版自定义">#</a> Promise (class 版) 自定义</h2><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/**</pre></td></tr><tr><td data-num="2"></td><td><pre> * 自定义 Promise 模块： IIFE</pre></td></tr><tr><td data-num="3"></td><td><pre> */</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">const</span> <span class="token constant">PENDING</span> <span class="token operator">=</span> <span class="token string">'pending'</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">const</span> <span class="token constant">RESOLVED</span> <span class="token operator">=</span> <span class="token string">'resolved'</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">const</span> <span class="token constant">REJECTED</span> <span class="token operator">=</span> <span class="token string">'rejected'</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Promise</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="13"></td><td><pre>     * Promise 构造函数</pre></td></tr><tr><td data-num="14"></td><td><pre>     * excutor：执行器函数（同步执行的）</pre></td></tr><tr><td data-num="15"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">excutor</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token comment">// 讲当前 promise 对象保存起来</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token keyword">const</span> self <span class="token operator">=</span> <span class="token keyword">this</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        self<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token constant">PENDING</span> <span class="token comment">// 给 promise 对象指定 status 属性，初始值为 pending</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        self<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token keyword">undefined</span>   <span class="token comment">// 给 promise 对象指定一个用于存储结果数据属性</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        self<span class="token punctuation">.</span>callbakcs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>     <span class="token comment">// 用于存储 then () 方法里的两个回调参数每个元素结构： &#123; onResolved ()&#123;&#125;, onRejected ()&#123;&#125;&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">function</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            <span class="token comment">// 如果当前状态不是 pending，直接结束</span></pre></td></tr><tr><td data-num="26"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>status <span class="token operator">!==</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>                <span class="token keyword">return</span>  <span class="token comment">// 默认 undefined</span></pre></td></tr><tr><td data-num="28"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre>            <span class="token comment">// 讲状态改为 resolved</span></pre></td></tr><tr><td data-num="31"></td><td><pre>            self<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token constant">RESOLVED</span></pre></td></tr><tr><td data-num="32"></td><td><pre>            <span class="token comment">// 保存 value 数据</span></pre></td></tr><tr><td data-num="33"></td><td><pre>            self<span class="token punctuation">.</span>data <span class="token operator">=</span> value</pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre>            <span class="token comment">// 如果有待执行的 callback 函数，立即异步执行回调函数 onResolved</span></pre></td></tr><tr><td data-num="36"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>callbakcs<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>                <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>                    self<span class="token punctuation">.</span>callbakcs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">callbakcsObj</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>                        callbakcsObj<span class="token punctuation">.</span><span class="token function">onResolved</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>                    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="44"></td><td><pre></pre></td></tr><tr><td data-num="45"></td><td><pre>        <span class="token keyword">function</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>            <span class="token comment">// 如果当前状态不是 pending，直接结束</span></pre></td></tr><tr><td data-num="47"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>status <span class="token operator">!==</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>                <span class="token keyword">return</span></pre></td></tr><tr><td data-num="49"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="50"></td><td><pre></pre></td></tr><tr><td data-num="51"></td><td><pre>            <span class="token comment">// 讲状态改为 resolved</span></pre></td></tr><tr><td data-num="52"></td><td><pre>            self<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token constant">REJECTED</span></pre></td></tr><tr><td data-num="53"></td><td><pre>            <span class="token comment">// 保存 value 数据</span></pre></td></tr><tr><td data-num="54"></td><td><pre>            self<span class="token punctuation">.</span>data <span class="token operator">=</span> reason</pre></td></tr><tr><td data-num="55"></td><td><pre>            <span class="token comment">// 如果由待执行的 callback 函数，立即异步执行回调函数 onResolved</span></pre></td></tr><tr><td data-num="56"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>callbakcs<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>                <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span> <span class="token comment">// 放入队列中执行所有成功的回调</span></pre></td></tr><tr><td data-num="58"></td><td><pre>                    self<span class="token punctuation">.</span>callbakcs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">callbakcsObj</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>                        callbakcsObj<span class="token punctuation">.</span><span class="token function">onRejected</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="60"></td><td><pre>                    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="62"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="64"></td><td><pre></pre></td></tr><tr><td data-num="65"></td><td><pre>        </pre></td></tr><tr><td data-num="66"></td><td><pre>        <span class="token comment">// 立即同步执行 excutor</span></pre></td></tr><tr><td data-num="67"></td><td><pre>        <span class="token comment">// 注意理解点，此处调用了 excutor () 函数 (也就是传入的 (resolve,reject)=>&#123;&#125;),</span></pre></td></tr><tr><td data-num="68"></td><td><pre>        <span class="token comment">// 并将上面的 resolve 函数和 reject 函数传出，所以外部才能直接调用 resolve ()/ 或 reject ()</span></pre></td></tr><tr><td data-num="69"></td><td><pre>        <span class="token keyword">try</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>            <span class="token function">excutor</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="71"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="72"></td><td><pre>            <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="73"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>        </pre></td></tr><tr><td data-num="75"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="76"></td><td><pre></pre></td></tr><tr><td data-num="77"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="78"></td><td><pre>     * Promise 原型对象上的 then () 方法，接收两个参数</pre></td></tr><tr><td data-num="79"></td><td><pre>     * 指定成功和失败的回调函数</pre></td></tr><tr><td data-num="80"></td><td><pre>     * 返回一个新的 promise 对象</pre></td></tr><tr><td data-num="81"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="82"></td><td><pre>    <span class="token comment">// 如果已有 then ()</span></pre></td></tr><tr><td data-num="83"></td><td><pre>     <span class="token function-variable function">then</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">onResolved<span class="token punctuation">,</span> onRejected</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="84"></td><td><pre>        </pre></td></tr><tr><td data-num="85"></td><td><pre>        <span class="token comment">// 向后传递成功的 value</span></pre></td></tr><tr><td data-num="86"></td><td><pre>        onResolved <span class="token operator">=</span> <span class="token keyword">typeof</span> onResolved <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">?</span> <span class="token function-variable function">onResolved</span> <span class="token operator">:</span> <span class="token parameter">value</span> <span class="token operator">=></span> value</pre></td></tr><tr><td data-num="87"></td><td><pre></pre></td></tr><tr><td data-num="88"></td><td><pre>        <span class="token comment">// 如果 then 里面没有指定失败回调，就默认使用之歌异常传透，向后传递失败的 reason</span></pre></td></tr><tr><td data-num="89"></td><td><pre>        onRejected <span class="token operator">=</span> <span class="token keyword">typeof</span> onRejected <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">?</span> <span class="token function-variable function">onRejected</span> <span class="token operator">:</span> <span class="token parameter">reason</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token keyword">throw</span> reason<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="90"></td><td><pre></pre></td></tr><tr><td data-num="91"></td><td><pre>        <span class="token keyword">const</span> self <span class="token operator">=</span> <span class="token keyword">this</span></pre></td></tr><tr><td data-num="92"></td><td><pre>        </pre></td></tr><tr><td data-num="93"></td><td><pre>        <span class="token comment">// 返回一个新的 promise 对象</span></pre></td></tr><tr><td data-num="94"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="95"></td><td><pre>            <span class="token comment">// 调用指定回调函数处理，根据执行结果，改变 return 的 promise 状态</span></pre></td></tr><tr><td data-num="96"></td><td><pre>            <span class="token keyword">function</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="97"></td><td><pre>                <span class="token comment">/**</pre></td></tr><tr><td data-num="98"></td><td><pre>                     * 1。如果抛出异常，return 的 promise 就会失败，reason 就是 error</pre></td></tr><tr><td data-num="99"></td><td><pre>                     * 2. 如果回调函数返回的不是 promise 对象，return 的 promise 就会成功，value 就是返回的值</pre></td></tr><tr><td data-num="100"></td><td><pre>                     * 3. 如果回调函数返回的是 promise，return 的 promise 结果就是这个 promise 的结果</pre></td></tr><tr><td data-num="101"></td><td><pre>                     */</span></pre></td></tr><tr><td data-num="102"></td><td><pre>                    <span class="token keyword">try</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="103"></td><td><pre>                        <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">callback</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="104"></td><td><pre>                        <span class="token comment">//3. 如果回调函数返回的是 promise，return 的 promise 结果就是这个 promise 的结果</span></pre></td></tr><tr><td data-num="105"></td><td><pre>                        <span class="token keyword">if</span><span class="token punctuation">(</span>result <span class="token keyword">instanceof</span> <span class="token class-name">Promise</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="106"></td><td><pre>                            result<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token comment">// 调用 then 纸是为了得到返回的 promise 的值，value 和 reason</span></pre></td></tr><tr><td data-num="107"></td><td><pre>                                <span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 此处的 resolve 调的是上面 new 出的 promise 对象的</span></pre></td></tr><tr><td data-num="108"></td><td><pre>                                <span class="token parameter">reason</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="109"></td><td><pre></pre></td></tr><tr><td data-num="110"></td><td><pre>                                <span class="token comment">// 第二种简便写法</span></pre></td></tr><tr><td data-num="111"></td><td><pre>                                <span class="token comment">//result.then(resolve, reject)</span></pre></td></tr><tr><td data-num="112"></td><td><pre>                            <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="113"></td><td><pre>                        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="114"></td><td><pre>                            <span class="token comment">//2. 如果回调函数返回的不是 promise 对象，return 的 promise 就会成功，value 就是返回的值</span></pre></td></tr><tr><td data-num="115"></td><td><pre>                            <span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="116"></td><td><pre>                        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="117"></td><td><pre>                    <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="118"></td><td><pre>                        <span class="token comment">//1。如果抛出异常，return 的 promise 就会失败，reason 就是 error</span></pre></td></tr><tr><td data-num="119"></td><td><pre>                        <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="120"></td><td><pre>                    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="121"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="122"></td><td><pre></pre></td></tr><tr><td data-num="123"></td><td><pre></pre></td></tr><tr><td data-num="124"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="125"></td><td><pre>                <span class="token comment">// 假设当前状态还是 pending 状态，将回调函数保存起来</span></pre></td></tr><tr><td data-num="126"></td><td><pre>                self<span class="token punctuation">.</span>callbakcs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="127"></td><td><pre>                    <span class="token function">onResolved</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="128"></td><td><pre>                        <span class="token comment">// 通过调用 onResolved 来调用 handle，以至于能获取新 promise 对象的状态并返回</span></pre></td></tr><tr><td data-num="129"></td><td><pre>                        <span class="token comment">// 没有 handle (onResolved)，就无法获取新 promise 的状态</span></pre></td></tr><tr><td data-num="130"></td><td><pre>                        <span class="token function">handle</span><span class="token punctuation">(</span>onResolved<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="131"></td><td><pre>                    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="132"></td><td><pre>                    <span class="token function">onRejected</span><span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="133"></td><td><pre>                        <span class="token function">handle</span><span class="token punctuation">(</span>onRejected<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="134"></td><td><pre>                    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="135"></td><td><pre>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="136"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token constant">RESOLVED</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="137"></td><td><pre>                <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="138"></td><td><pre>                    <span class="token function">handle</span><span class="token punctuation">(</span>onResolved<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="139"></td><td><pre>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="140"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="141"></td><td><pre>                <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="142"></td><td><pre>                    <span class="token function">handle</span><span class="token punctuation">(</span>onRejected<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="143"></td><td><pre>                    </pre></td></tr><tr><td data-num="144"></td><td><pre>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="145"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="146"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="147"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="148"></td><td><pre></pre></td></tr><tr><td data-num="149"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="150"></td><td><pre>     * Promise 原型对象上的 catch 方法（接收一个参数</pre></td></tr><tr><td data-num="151"></td><td><pre>     * 指定一个失败的回调对象</pre></td></tr><tr><td data-num="152"></td><td><pre>     * 返回一个新的 promise 对象</pre></td></tr><tr><td data-num="153"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="154"></td><td><pre>    <span class="token function-variable function">catch</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">onRejected</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="155"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">,</span> onRejected<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="156"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="157"></td><td><pre></pre></td></tr><tr><td data-num="158"></td><td><pre></pre></td></tr><tr><td data-num="159"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="160"></td><td><pre>     * Promise 函数对象的 resolve 方法</pre></td></tr><tr><td data-num="161"></td><td><pre>     * 返回一个指定 value 的成功的 promise 对象</pre></td></tr><tr><td data-num="162"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="163"></td><td><pre>    <span class="token keyword">static</span> <span class="token function-variable function">resolve</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="164"></td><td><pre>        </pre></td></tr><tr><td data-num="165"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="166"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>value <span class="token keyword">instanceof</span> <span class="token class-name">Promise</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// 如果传入的是一个 promise 成功对象</span></pre></td></tr><tr><td data-num="167"></td><td><pre>                value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="168"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token comment">// 如果传入的是一个非 promise</span></pre></td></tr><tr><td data-num="169"></td><td><pre>                <span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="170"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="171"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="172"></td><td><pre></pre></td></tr><tr><td data-num="173"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="174"></td><td><pre></pre></td></tr><tr><td data-num="175"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="176"></td><td><pre>     * 注意：Promise.reject 方法不能传入一个一个 promise 对象</pre></td></tr><tr><td data-num="177"></td><td><pre>     * Promise 函数对象的 reject 方法</pre></td></tr><tr><td data-num="178"></td><td><pre>     * 返回一个指定 reason 的失败的的 promise 对象</pre></td></tr><tr><td data-num="179"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="180"></td><td><pre>    <span class="token keyword">static</span> <span class="token function-variable function">reject</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="181"></td><td><pre>        <span class="token comment">// 返回一个失败的 promise 对象</span></pre></td></tr><tr><td data-num="182"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="183"></td><td><pre>            <span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="184"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="185"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="186"></td><td><pre></pre></td></tr><tr><td data-num="187"></td><td><pre></pre></td></tr><tr><td data-num="188"></td><td><pre></pre></td></tr><tr><td data-num="189"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="190"></td><td><pre>     * Promise 函数对象的 all 方法</pre></td></tr><tr><td data-num="191"></td><td><pre>     * 返回一个 promise，只用当所有 promise 都成功时才成功，否则只要有一个失败的就失败</pre></td></tr><tr><td data-num="192"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="193"></td><td><pre>    <span class="token keyword">static</span> <span class="token function-variable function">all</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">promises</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="194"></td><td><pre>        </pre></td></tr><tr><td data-num="195"></td><td><pre>        <span class="token comment">// 创建一个数组来接收成功的值</span></pre></td></tr><tr><td data-num="196"></td><td><pre>        <span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>promises<span class="token punctuation">.</span>length<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="197"></td><td><pre></pre></td></tr><tr><td data-num="198"></td><td><pre>        <span class="token comment">// 保存成功 promise 的对象</span></pre></td></tr><tr><td data-num="199"></td><td><pre>        <span class="token keyword">let</span> resolvedCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="200"></td><td><pre></pre></td></tr><tr><td data-num="201"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>           </pre></td></tr><tr><td data-num="202"></td><td><pre>            <span class="token comment">// 判断传进来的每个 promise 的状态</span></pre></td></tr><tr><td data-num="203"></td><td><pre>            promises<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">p<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="204"></td><td><pre>                p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>  <span class="token comment">// 通过 then 防范取得状态值，为了应对如果数组里的值非 promise 对象，需要 Promise.resolve () 来包装 p</span></pre></td></tr><tr><td data-num="205"></td><td><pre>                    <span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="206"></td><td><pre>                        resolvedCount<span class="token operator">++</span></pre></td></tr><tr><td data-num="207"></td><td><pre>                        <span class="token comment">// 如果成功则保存成功的值</span></pre></td></tr><tr><td data-num="208"></td><td><pre>                        values<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> value</pre></td></tr><tr><td data-num="209"></td><td><pre></pre></td></tr><tr><td data-num="210"></td><td><pre>                        <span class="token comment">// 如果所有 promise 对象都成功的话就返回成功的 promise 对象</span></pre></td></tr><tr><td data-num="211"></td><td><pre>                        <span class="token keyword">if</span><span class="token punctuation">(</span>resolvedCount <span class="token operator">===</span> promises<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="212"></td><td><pre>                            <span class="token function">resolve</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="213"></td><td><pre>                        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="214"></td><td><pre>                    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="215"></td><td><pre>                    <span class="token parameter">reason</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="216"></td><td><pre>                        <span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="217"></td><td><pre>                    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="218"></td><td><pre>                <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="219"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="220"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="221"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="222"></td><td><pre></pre></td></tr><tr><td data-num="223"></td><td><pre></pre></td></tr><tr><td data-num="224"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="225"></td><td><pre>     * Promise 函数对象的 race 方法</pre></td></tr><tr><td data-num="226"></td><td><pre>     * 返回一个 promise，其结果由第一个先确定状态的 promise 决定</pre></td></tr><tr><td data-num="227"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="228"></td><td><pre>    <span class="token keyword">static</span> <span class="token function-variable function">race</span><span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">promises</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="229"></td><td><pre>        </pre></td></tr><tr><td data-num="230"></td><td><pre>        <span class="token comment">// 注意，promise 的状态一旦确定，就无法改变</span></pre></td></tr><tr><td data-num="231"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="232"></td><td><pre>            <span class="token comment">// 遍历传进来的每个 promise 对象</span></pre></td></tr><tr><td data-num="233"></td><td><pre>            promises<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">p<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="234"></td><td><pre>                Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token comment">// 通过 then 防范取得状态值，为了应对如果数组里的值非 promise 对象，需要 Promise.resolve () 来包装 p</span></pre></td></tr><tr><td data-num="235"></td><td><pre>                    <span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  <span class="token comment">// 一旦有一个成功就将返回的 promise 对象变为成功</span></pre></td></tr><tr><td data-num="236"></td><td><pre>                        <span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="237"></td><td><pre>                    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="238"></td><td><pre>                    <span class="token parameter">reason</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span> <span class="token comment">// 一旦有一个失败就将返回的 promise 对象变为失败</span></pre></td></tr><tr><td data-num="239"></td><td><pre>                        <span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="240"></td><td><pre>                    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="241"></td><td><pre>                <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="242"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="243"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="244"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="245"></td><td><pre></pre></td></tr><tr><td data-num="246"></td><td><pre></pre></td></tr><tr><td data-num="247"></td><td><pre></pre></td></tr><tr><td data-num="248"></td><td><pre>    <span class="token comment">//Promise 延迟成功的方法，固定时间后返回一个成功的 promise 对象</span></pre></td></tr><tr><td data-num="249"></td><td><pre>    <span class="token keyword">static</span> <span class="token function-variable function">resolveDelay</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> time</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="250"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="251"></td><td><pre>            <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="252"></td><td><pre>                <span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="253"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="254"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="255"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="256"></td><td><pre>        </pre></td></tr><tr><td data-num="257"></td><td><pre>    </pre></td></tr><tr><td data-num="258"></td><td><pre>    <span class="token comment">//Promise 延迟失败的方法，固定时间后返回一个失败的 promise 对象</span></pre></td></tr><tr><td data-num="259"></td><td><pre>    <span class="token keyword">static</span> <span class="token function-variable function">rejectDelay</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> time</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="260"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="261"></td><td><pre>            <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="262"></td><td><pre>                <span class="token function">reject</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="263"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="264"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="265"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="266"></td><td><pre></pre></td></tr><tr><td data-num="267"></td><td><pre></pre></td></tr><tr><td data-num="268"></td><td><pre></pre></td></tr><tr><td data-num="269"></td><td><pre>     <span class="token comment">// 向外暴露 Promise 函数</span></pre></td></tr><tr><td data-num="270"></td><td><pre>    <span class="token comment">//  window.Promise = Promise</span></pre></td></tr><tr><td data-num="271"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://yoursite.com/categories/javascript/"/>
    
    
      <category term="promise" scheme="http://yoursite.com/tags/promise/"/>
    
  </entry>
  
  <entry>
    <title>Promise自定义</title>
    <link href="http://yoursite.com/2020/11/16/2020-11-16-3/"/>
    <id>http://yoursite.com/2020/11/16/2020-11-16-3/</id>
    <published>2020-11-16T07:42:24.422Z</published>
    <updated>2020-11-16T11:54:53.339Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="promise自定义"><a class="anchor" href="#promise自定义">#</a> Promise 自定义</h2><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/**</pre></td></tr><tr><td data-num="2"></td><td><pre> * 自定义 Promise 模块： IIFE</pre></td></tr><tr><td data-num="3"></td><td><pre> */</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">window</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">const</span> <span class="token constant">PENDING</span> <span class="token operator">=</span> <span class="token string">'pending'</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">const</span> <span class="token constant">RESOLVED</span> <span class="token operator">=</span> <span class="token string">'resolved'</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">const</span> <span class="token constant">REJECTED</span> <span class="token operator">=</span> <span class="token string">'rejected'</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="10"></td><td><pre>     * Promise 构造函数</pre></td></tr><tr><td data-num="11"></td><td><pre>     * excutor：执行器函数（同步执行的）</pre></td></tr><tr><td data-num="12"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">function</span> <span class="token function">Promise</span><span class="token punctuation">(</span><span class="token parameter">excutor</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token comment">// 将当前 promise 对象保存起来</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token keyword">const</span> self <span class="token operator">=</span> <span class="token keyword">this</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        self<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token constant">PENDING</span> <span class="token comment">// 给 promise 对象指定 status 属性，初始值为 pending</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        self<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token keyword">undefined</span>   <span class="token comment">// 给 promise 对象指定一个用于存储结果数据属性</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        self<span class="token punctuation">.</span>callbakcs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>     <span class="token comment">// 用于存储 then () 方法里的两个回调参数每个元素结构： &#123; onResolved ()&#123;&#125;, onRejected ()&#123;&#125;&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token keyword">function</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>            <span class="token comment">// 如果当前状态不是 pending，直接结束</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>status <span class="token operator">!==</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>                <span class="token keyword">return</span>  <span class="token comment">// 默认 undefined</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre>            <span class="token comment">// 讲状态改为 resolved</span></pre></td></tr><tr><td data-num="28"></td><td><pre>            self<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token constant">RESOLVED</span></pre></td></tr><tr><td data-num="29"></td><td><pre>            <span class="token comment">// 保存 value 数据</span></pre></td></tr><tr><td data-num="30"></td><td><pre>            self<span class="token punctuation">.</span>data <span class="token operator">=</span> value</pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre>            <span class="token comment">// 如果有待执行的 callback 函数，立即异步执行回调函数 onResolved</span></pre></td></tr><tr><td data-num="33"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>callbakcs<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>                <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>                    self<span class="token punctuation">.</span>callbakcs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">callbakcsObj</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>                        callbakcsObj<span class="token punctuation">.</span><span class="token function">onResolved</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>                    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre>        <span class="token keyword">function</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>            <span class="token comment">// 如果当前状态不是 pending，直接结束</span></pre></td></tr><tr><td data-num="44"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>status <span class="token operator">!==</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>                <span class="token keyword">return</span></pre></td></tr><tr><td data-num="46"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="47"></td><td><pre></pre></td></tr><tr><td data-num="48"></td><td><pre>            <span class="token comment">// 讲状态改为 resolved</span></pre></td></tr><tr><td data-num="49"></td><td><pre>            self<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token constant">REJECTED</span></pre></td></tr><tr><td data-num="50"></td><td><pre>            <span class="token comment">// 保存 value 数据</span></pre></td></tr><tr><td data-num="51"></td><td><pre>            self<span class="token punctuation">.</span>data <span class="token operator">=</span> reason</pre></td></tr><tr><td data-num="52"></td><td><pre>            <span class="token comment">// 如果由待执行的 callback 函数，立即异步执行回调函数 onResolved</span></pre></td></tr><tr><td data-num="53"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>callbakcs<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>                <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span> <span class="token comment">// 放入队列中执行所有成功的回调</span></pre></td></tr><tr><td data-num="55"></td><td><pre>                    self<span class="token punctuation">.</span>callbakcs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">callbakcsObj</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>                        callbakcsObj<span class="token punctuation">.</span><span class="token function">onRejected</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="57"></td><td><pre>                    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="59"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="61"></td><td><pre></pre></td></tr><tr><td data-num="62"></td><td><pre>        </pre></td></tr><tr><td data-num="63"></td><td><pre>        <span class="token comment">// 立即同步执行 excutor</span></pre></td></tr><tr><td data-num="64"></td><td><pre>        <span class="token comment">// 注意理解点，此处调用了 excutor () 函数 (也就是传入的 (resolve,reject)=>&#123;&#125;),</span></pre></td></tr><tr><td data-num="65"></td><td><pre>        <span class="token comment">// 并将上面的 resolve 函数和 reject 函数传出，所以外部才能直接调用 resolve ()/ 或 reject ()</span></pre></td></tr><tr><td data-num="66"></td><td><pre>        <span class="token keyword">try</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>            <span class="token function">excutor</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="68"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>            <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="70"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>        </pre></td></tr><tr><td data-num="72"></td><td><pre>        </pre></td></tr><tr><td data-num="73"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="74"></td><td><pre></pre></td></tr><tr><td data-num="75"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="76"></td><td><pre>     * Promise 原型对象上的 then () 方法，接收两个参数</pre></td></tr><tr><td data-num="77"></td><td><pre>     * 指定成功和失败的回调函数</pre></td></tr><tr><td data-num="78"></td><td><pre>     * 返回一个新的 promise 对象</pre></td></tr><tr><td data-num="79"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="80"></td><td><pre>    <span class="token comment">// 如果已有 then ()</span></pre></td></tr><tr><td data-num="81"></td><td><pre>    <span class="token class-name">Promise</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">then</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">onResolved<span class="token punctuation">,</span> onRejected</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>        </pre></td></tr><tr><td data-num="83"></td><td><pre>        <span class="token comment">// 向后传递成功的 value</span></pre></td></tr><tr><td data-num="84"></td><td><pre>        onResolved <span class="token operator">=</span> <span class="token keyword">typeof</span> onResolved <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">?</span> <span class="token function-variable function">onResolved</span> <span class="token operator">:</span> <span class="token parameter">value</span> <span class="token operator">=></span> value</pre></td></tr><tr><td data-num="85"></td><td><pre></pre></td></tr><tr><td data-num="86"></td><td><pre>        <span class="token comment">// 如果 then 里面没有指定失败回调，就默认使用之歌异常传透，向后传递失败的 reason</span></pre></td></tr><tr><td data-num="87"></td><td><pre>        onRejected <span class="token operator">=</span> <span class="token keyword">typeof</span> onRejected <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">?</span> <span class="token function-variable function">onRejected</span> <span class="token operator">:</span> <span class="token parameter">reason</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token keyword">throw</span> reason<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="88"></td><td><pre></pre></td></tr><tr><td data-num="89"></td><td><pre>        <span class="token keyword">const</span> self <span class="token operator">=</span> <span class="token keyword">this</span></pre></td></tr><tr><td data-num="90"></td><td><pre>        </pre></td></tr><tr><td data-num="91"></td><td><pre>        <span class="token comment">// 返回一个新的 promise 对象</span></pre></td></tr><tr><td data-num="92"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="93"></td><td><pre>            <span class="token comment">// 调用指定回调函数处理，根据执行结果，改变 return 的 promise 状态</span></pre></td></tr><tr><td data-num="94"></td><td><pre>            <span class="token keyword">function</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="95"></td><td><pre>                <span class="token comment">/**</pre></td></tr><tr><td data-num="96"></td><td><pre>                     * 1。如果抛出异常，return 的 promise 就会失败，reason 就是 error</pre></td></tr><tr><td data-num="97"></td><td><pre>                     * 2. 如果回调函数返回的不是 promise 对象，return 的 promise 就会成功，value 就是返回的值</pre></td></tr><tr><td data-num="98"></td><td><pre>                     * 3. 如果回调函数返回的是 promise，return 的 promise 结果就是这个 promise 的结果</pre></td></tr><tr><td data-num="99"></td><td><pre>                     */</span></pre></td></tr><tr><td data-num="100"></td><td><pre>                    <span class="token keyword">try</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="101"></td><td><pre>                        <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">callback</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="102"></td><td><pre>                        <span class="token comment">//3. 如果回调函数返回的是 promise，return 的 promise 结果就是这个 promise 的结果</span></pre></td></tr><tr><td data-num="103"></td><td><pre>                        <span class="token keyword">if</span><span class="token punctuation">(</span>result <span class="token keyword">instanceof</span> <span class="token class-name">Promise</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="104"></td><td><pre>                            result<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token comment">// 调用 then 纸是为了得到返回的 promise 的值，value 和 reason</span></pre></td></tr><tr><td data-num="105"></td><td><pre>                                <span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 此处的 resolve 调的是上面 new 出的 promise 对象的</span></pre></td></tr><tr><td data-num="106"></td><td><pre>                                <span class="token parameter">reason</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="107"></td><td><pre></pre></td></tr><tr><td data-num="108"></td><td><pre>                                <span class="token comment">// 第二种简便写法</span></pre></td></tr><tr><td data-num="109"></td><td><pre>                                <span class="token comment">//result.then(resolve, reject)</span></pre></td></tr><tr><td data-num="110"></td><td><pre>                            <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="111"></td><td><pre>                        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="112"></td><td><pre>                            <span class="token comment">//2. 如果回调函数返回的不是 promise 对象，return 的 promise 就会成功，value 就是返回的值</span></pre></td></tr><tr><td data-num="113"></td><td><pre>                            <span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="114"></td><td><pre>                        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="115"></td><td><pre>                    <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="116"></td><td><pre>                        <span class="token comment">//1。如果抛出异常，return 的 promise 就会失败，reason 就是 error</span></pre></td></tr><tr><td data-num="117"></td><td><pre>                        <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="118"></td><td><pre>                    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="119"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="120"></td><td><pre></pre></td></tr><tr><td data-num="121"></td><td><pre></pre></td></tr><tr><td data-num="122"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="123"></td><td><pre>                <span class="token comment">// 假设当前状态还是 pending 状态，将回调函数保存起来</span></pre></td></tr><tr><td data-num="124"></td><td><pre>                self<span class="token punctuation">.</span>callbakcs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="125"></td><td><pre>                    <span class="token function">onResolved</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="126"></td><td><pre>                        <span class="token comment">// 通过调用 onResolved 来调用 handle，以至于能获取新 promise 对象的状态并返回</span></pre></td></tr><tr><td data-num="127"></td><td><pre>                        <span class="token comment">// 没有 handle (onResolved)，就无法获取新 promise 的状态</span></pre></td></tr><tr><td data-num="128"></td><td><pre>                        <span class="token function">handle</span><span class="token punctuation">(</span>onResolved<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="129"></td><td><pre>                    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="130"></td><td><pre>                    <span class="token function">onRejected</span><span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="131"></td><td><pre>                        <span class="token function">handle</span><span class="token punctuation">(</span>onRejected<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="132"></td><td><pre>                    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="133"></td><td><pre>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="134"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token constant">RESOLVED</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="135"></td><td><pre>                <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="136"></td><td><pre>                    <span class="token function">handle</span><span class="token punctuation">(</span>onResolved<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="137"></td><td><pre>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="138"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="139"></td><td><pre>                <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="140"></td><td><pre>                    <span class="token function">handle</span><span class="token punctuation">(</span>onRejected<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="141"></td><td><pre>                    </pre></td></tr><tr><td data-num="142"></td><td><pre>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="143"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="144"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="145"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="146"></td><td><pre></pre></td></tr><tr><td data-num="147"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="148"></td><td><pre>     * Promise 原型对象上的 catch 方法（接收一个参数</pre></td></tr><tr><td data-num="149"></td><td><pre>     * 指定一个失败的回调对象</pre></td></tr><tr><td data-num="150"></td><td><pre>     * 返回一个新的 promise 对象</pre></td></tr><tr><td data-num="151"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="152"></td><td><pre>    <span class="token class-name">Promise</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">catch</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">onRejected</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="153"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">,</span> onRejected<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="154"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="155"></td><td><pre></pre></td></tr><tr><td data-num="156"></td><td><pre></pre></td></tr><tr><td data-num="157"></td><td><pre>    <span class="token comment">/** 工具方法</pre></td></tr><tr><td data-num="158"></td><td><pre>     * Promise 函数对象的 resolve 方法</pre></td></tr><tr><td data-num="159"></td><td><pre>     * 返回一个指定 value 的成功的 promise 对象</pre></td></tr><tr><td data-num="160"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="161"></td><td><pre>    Promise<span class="token punctuation">.</span><span class="token function-variable function">resolve</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="162"></td><td><pre>        </pre></td></tr><tr><td data-num="163"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="164"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>value <span class="token keyword">instanceof</span> <span class="token class-name">Promise</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// 如果传入的是一个 promise 成功对象</span></pre></td></tr><tr><td data-num="165"></td><td><pre>                value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="166"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token comment">// 如果传入的是一个非 promise</span></pre></td></tr><tr><td data-num="167"></td><td><pre>                <span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="168"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="169"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="170"></td><td><pre></pre></td></tr><tr><td data-num="171"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="172"></td><td><pre></pre></td></tr><tr><td data-num="173"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="174"></td><td><pre>     * 注意：Promise.reject 方法不能传入一个一个 promise 对象</pre></td></tr><tr><td data-num="175"></td><td><pre>     * Promise 函数对象的 reject 方法</pre></td></tr><tr><td data-num="176"></td><td><pre>     * 返回一个指定 reason 的失败的的 promise 对象</pre></td></tr><tr><td data-num="177"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="178"></td><td><pre>    Promise<span class="token punctuation">.</span><span class="token function-variable function">reject</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">reason</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="179"></td><td><pre>        <span class="token comment">// 返回一个失败的 promise 对象</span></pre></td></tr><tr><td data-num="180"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="181"></td><td><pre>            <span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="182"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="183"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="184"></td><td><pre></pre></td></tr><tr><td data-num="185"></td><td><pre></pre></td></tr><tr><td data-num="186"></td><td><pre></pre></td></tr><tr><td data-num="187"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="188"></td><td><pre>     * Promise 函数对象的 all 方法</pre></td></tr><tr><td data-num="189"></td><td><pre>     * 返回一个 promise，只用当所有 promise 都成功时才成功，否则只要有一个失败的就失败</pre></td></tr><tr><td data-num="190"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="191"></td><td><pre>    Promise<span class="token punctuation">.</span><span class="token function-variable function">all</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">promises</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="192"></td><td><pre>        </pre></td></tr><tr><td data-num="193"></td><td><pre>        <span class="token comment">// 创建一个数组来接收成功的值</span></pre></td></tr><tr><td data-num="194"></td><td><pre>        <span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>promises<span class="token punctuation">.</span>length<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="195"></td><td><pre></pre></td></tr><tr><td data-num="196"></td><td><pre>        <span class="token comment">// 保存成功 promise 的对象</span></pre></td></tr><tr><td data-num="197"></td><td><pre>        <span class="token keyword">let</span> resolvedCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="198"></td><td><pre></pre></td></tr><tr><td data-num="199"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>           </pre></td></tr><tr><td data-num="200"></td><td><pre>            <span class="token comment">// 判断传进来的每个 promise 的状态</span></pre></td></tr><tr><td data-num="201"></td><td><pre>            promises<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">p<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="202"></td><td><pre>                p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>  <span class="token comment">// 通过 then 防范取得状态值，为了应对如果数组里的值非 promise 对象，需要 Promise.resolve () 来包装 p</span></pre></td></tr><tr><td data-num="203"></td><td><pre>                    <span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="204"></td><td><pre>                        resolvedCount<span class="token operator">++</span></pre></td></tr><tr><td data-num="205"></td><td><pre>                        <span class="token comment">// 如果成功则保存成功的值</span></pre></td></tr><tr><td data-num="206"></td><td><pre>                        values<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> value</pre></td></tr><tr><td data-num="207"></td><td><pre></pre></td></tr><tr><td data-num="208"></td><td><pre>                        <span class="token comment">// 如果所有 promise 对象都成功的话就返回成功的 promise 对象</span></pre></td></tr><tr><td data-num="209"></td><td><pre>                        <span class="token keyword">if</span><span class="token punctuation">(</span>resolvedCount <span class="token operator">===</span> promises<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="210"></td><td><pre>                            <span class="token function">resolve</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="211"></td><td><pre>                        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="212"></td><td><pre>                    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="213"></td><td><pre>                    <span class="token parameter">reason</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="214"></td><td><pre>                        <span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="215"></td><td><pre>                    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="216"></td><td><pre>                <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="217"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="218"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="219"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="220"></td><td><pre></pre></td></tr><tr><td data-num="221"></td><td><pre></pre></td></tr><tr><td data-num="222"></td><td><pre>    <span class="token comment">/**</pre></td></tr><tr><td data-num="223"></td><td><pre>     * Promise 函数对象的 race 方法</pre></td></tr><tr><td data-num="224"></td><td><pre>     * 返回一个 promise，其结果由第一个先确定状态的 promise 决定</pre></td></tr><tr><td data-num="225"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="226"></td><td><pre>    Promise<span class="token punctuation">.</span><span class="token function-variable function">race</span><span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">promises</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="227"></td><td><pre>        </pre></td></tr><tr><td data-num="228"></td><td><pre>        <span class="token comment">// 注意，promise 的状态一旦确定，就无法改变</span></pre></td></tr><tr><td data-num="229"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="230"></td><td><pre>            <span class="token comment">// 遍历传进来的每个 promise 对象</span></pre></td></tr><tr><td data-num="231"></td><td><pre>            promises<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">p<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="232"></td><td><pre>                Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token comment">// 通过 then 防范取得状态值，为了应对如果数组里的值非 promise 对象，需要 Promise.resolve () 来包装 p</span></pre></td></tr><tr><td data-num="233"></td><td><pre>                    <span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>  <span class="token comment">// 一旦有一个成功就将返回的 promise 对象变为成功</span></pre></td></tr><tr><td data-num="234"></td><td><pre>                        <span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="235"></td><td><pre>                    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="236"></td><td><pre>                    <span class="token parameter">reason</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span> <span class="token comment">// 一旦有一个失败就将返回的 promise 对象变为失败</span></pre></td></tr><tr><td data-num="237"></td><td><pre>                        <span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="238"></td><td><pre>                    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="239"></td><td><pre>                <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="240"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="241"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="242"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="243"></td><td><pre></pre></td></tr><tr><td data-num="244"></td><td><pre></pre></td></tr><tr><td data-num="245"></td><td><pre></pre></td></tr><tr><td data-num="246"></td><td><pre>    <span class="token comment">//Promise 延迟成功的方法，固定时间后返回一个成功的 promise 对象</span></pre></td></tr><tr><td data-num="247"></td><td><pre>    Promise<span class="token punctuation">.</span><span class="token function-variable function">resolveDelay</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> time</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="248"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="249"></td><td><pre>            <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="250"></td><td><pre>                <span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="251"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="252"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="253"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="254"></td><td><pre>        </pre></td></tr><tr><td data-num="255"></td><td><pre>    </pre></td></tr><tr><td data-num="256"></td><td><pre>    <span class="token comment">//Promise 延迟失败的方法，固定时间后返回一个失败的 promise 对象</span></pre></td></tr><tr><td data-num="257"></td><td><pre>    Promise<span class="token punctuation">.</span><span class="token function-variable function">rejectDelay</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> time</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="258"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="259"></td><td><pre>            <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="260"></td><td><pre>                <span class="token function">reject</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="261"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="262"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="263"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="264"></td><td><pre></pre></td></tr><tr><td data-num="265"></td><td><pre></pre></td></tr><tr><td data-num="266"></td><td><pre></pre></td></tr><tr><td data-num="267"></td><td><pre>     <span class="token comment">// 向外暴露 Promise 函数</span></pre></td></tr><tr><td data-num="268"></td><td><pre>     window<span class="token punctuation">.</span>Promise <span class="token operator">=</span> Promise</pre></td></tr><tr><td data-num="269"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://yoursite.com/categories/javascript/"/>
    
    
      <category term="promise" scheme="http://yoursite.com/tags/promise/"/>
    
  </entry>
  
  <entry>
    <title>Promise问题一</title>
    <link href="http://yoursite.com/2020/11/16/2020-11-16-2/"/>
    <id>http://yoursite.com/2020/11/16/2020-11-16-2/</id>
    <published>2020-11-16T07:01:48.259Z</published>
    <updated>2020-11-16T07:23:04.585Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="1如何改变当前promise状态"><a class="anchor" href="#1如何改变当前promise状态">#</a> 1. 如何改变当前 promise 状态？</h2><h2 id="2一个promise指定多个成功失败回调函数都会调用吗"><a class="anchor" href="#2一个promise指定多个成功失败回调函数都会调用吗">#</a> 2. 一个 promise 指定多个成功 / 失败回调函数，都会调用吗？</h2><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/*</pre></td></tr><tr><td data-num="2"></td><td><pre>        1. 如何改变当前 promise 状态</pre></td></tr><tr><td data-num="3"></td><td><pre>        （1 resolve (value): 如果当前是 pending 就会编程 resolved</pre></td></tr><tr><td data-num="4"></td><td><pre>        （2 reject (reason): 如果当前 pending 就会变成 rejected</pre></td></tr><tr><td data-num="5"></td><td><pre>        （3 抛出异常：如果当前是 pending 就会变成为 rejected</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>        2. 一个 promise 指定多个成功 / 失败回调函数，都会调用吗？</pre></td></tr><tr><td data-num="8"></td><td><pre>            对应状态都会调用</pre></td></tr><tr><td data-num="9"></td><td><pre>    */</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    </pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token comment">//resolve (1)  promise 变为 resolved 成功状态</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token comment">//reject (2)   promise 变为 rejected 失败状态</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token comment">//throw new Error (' 出错了 ') // 抛出异常，promise 变为 rejected 失败状态，reason 为抛出的异常</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token keyword">throw</span> <span class="token number">3</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token parameter">value</span> <span class="token operator">=></span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token parameter">reason</span> <span class="token operator">=></span><span class="token punctuation">&#123;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'reason'</span><span class="token punctuation">,</span> reason<span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token comment">// 'reason'  3</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token parameter">value</span> <span class="token operator">=></span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token parameter">reason2</span> <span class="token operator">=></span><span class="token punctuation">&#123;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'reason2'</span><span class="token punctuation">,</span> reason2<span class="token punctuation">)</span><span class="token punctuation">&#125;</span> <span class="token comment">// 'reason2'  3</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr></table></figure><hr><h2 id="3改变promise状态和指定回调函数谁先谁后"><a class="anchor" href="#3改变promise状态和指定回调函数谁先谁后">#</a> 3. 改变 promise 状态和指定回调函数谁先谁后？</h2><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/*</pre></td></tr><tr><td data-num="2"></td><td><pre>        3. 改变 promise 状态和指定回调函数谁先谁后？</pre></td></tr><tr><td data-num="3"></td><td><pre>            （1 都有可能，正常情况下先指定回调再改变状态，但也可以先改变状态再指定回调</pre></td></tr><tr><td data-num="4"></td><td><pre>            （2  如何先改变状态再指定回调？</pre></td></tr><tr><td data-num="5"></td><td><pre>                执行器中直接调用 resolve () /reject ()</pre></td></tr><tr><td data-num="6"></td><td><pre>                延迟更长时间再去调用 then ()</pre></td></tr><tr><td data-num="7"></td><td><pre>            （3 什么时候才能得到数据</pre></td></tr><tr><td data-num="8"></td><td><pre>                如果先指定的回调，当状态发生改变时，就会调用回调函数，得到数据</pre></td></tr><tr><td data-num="9"></td><td><pre>                如果先改变状态，当指定回调时，回调函数就会调用，得到数据</pre></td></tr><tr><td data-num="10"></td><td><pre>    */</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token comment">// 常规：先指定回调函数，后改变的状态</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment">// 后改变的状态（同时指定数据），异步执行回调函数</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token comment">// 先指定回调函数，保存当前指定的回调函数</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token parameter">value</span> <span class="token operator">=></span><span class="token punctuation">&#123;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'value'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token parameter">reason</span> <span class="token operator">=></span><span class="token punctuation">&#123;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'reason'</span><span class="token punctuation">,</span>reason<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token comment">// 先改变状态，后指定回调函数</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// 先改变的状态（同时指定数据）</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token comment">// 后指定回调函数，异步执行回调函数</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token parameter">value</span> <span class="token operator">=></span><span class="token punctuation">&#123;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'value2'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token parameter">reason</span> <span class="token operator">=></span><span class="token punctuation">&#123;</span>cosnole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'reason'</span><span class="token punctuation">,</span> reason<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token keyword">const</span> p3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment">// 后改变的状态（同时指定数据），异步执行回调函数</span></pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        p3<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token comment">// 先指定回调函数，保存当前指定的回调函数</span></pre></td></tr><tr><td data-num="42"></td><td><pre>        <span class="token parameter">value</span> <span class="token operator">=></span><span class="token punctuation">&#123;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'value3'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token parameter">reason</span> <span class="token operator">=></span><span class="token punctuation">&#123;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'reason3'</span><span class="token punctuation">,</span>reason<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="44"></td><td><pre></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">1100</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><hr><h2 id="4promisethen返回的新promise的-结果状态-由什么决定"><a class="anchor" href="#4promisethen返回的新promise的-结果状态-由什么决定">#</a> 4.promise.then () 返回的新 promise 的 结果状态 由什么决定？</h2><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/*  //then 方法中的回调如果不指定返回值，下一个 then 默认调用的是成功的回调，值是 undefined</pre></td></tr><tr><td data-num="2"></td><td><pre>        4.promise.then () 返回的新 promise 的 结果状态 由什么决定？</pre></td></tr><tr><td data-num="3"></td><td><pre>            （1 简单表达：由 then () 指定的回调函数的执行结果决定</pre></td></tr><tr><td data-num="4"></td><td><pre>            （2 详细表达：</pre></td></tr><tr><td data-num="5"></td><td><pre>                如果抛出异常，新 promise 变为 rejected，reason 为抛出的异常</pre></td></tr><tr><td data-num="6"></td><td><pre>                如果返回的是非 promise 的任意值，新 promise 便为 resolved，value 为新返回的值</pre></td></tr><tr><td data-num="7"></td><td><pre>                如果返回的是另一个新的 promise，此 promise 的结果就会成为新 promise 的结果</pre></td></tr><tr><td data-num="8"></td><td><pre>    */</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token comment">// reject('w s shibai jieguo')</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'onResolved'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            <span class="token comment">// return 1</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            <span class="token comment">//throw ' 出错了！'</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            <span class="token comment">// throw '555！'</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            <span class="token comment">//return Promise.reject ('haha,you chenggong l !')  // 注意，此处是构造函数 Promise, 不是实例</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token parameter">reason</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'onRejected'</span><span class="token punctuation">,</span> reason<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>            <span class="token comment">//throw ' 出错了！'</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'onResolved2'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token parameter">reason</span> <span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'onRejected2'</span><span class="token punctuation">,</span> reason<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr></table></figure><hr><h2 id="5promise如何串连多个操作任务"><a class="anchor" href="#5promise如何串连多个操作任务">#</a> 5.promise 如何串连多个操作任务？</h2><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/*</pre></td></tr><tr><td data-num="2"></td><td><pre>        5.promise 如何串连多个操作任务？</pre></td></tr><tr><td data-num="3"></td><td><pre>            （1 promise 的 then () 返回一个新的 promise，可以开成 then () 的链式调用</pre></td></tr><tr><td data-num="4"></td><td><pre>            （2 通过 then 的链式调用串联的多个同步 / 异步任务</pre></td></tr><tr><td data-num="5"></td><td><pre>    */</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'执行任务1（异步）'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'任务1结果：'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'执行任务2（同步）'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span> <span class="token comment">// 如果要再 then 里的回调函数中继续执行异步操作，那就要用 promise 封装异步操作</span></pre></td></tr><tr><td data-num="20"></td><td><pre>            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>                <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'我是异步任务3'</span><span class="token punctuation">,</span>value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>                <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'我是同步任务4'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr></table></figure><hr><h2 throw="" reason="" id="6promise异常传穿透如果再then中没有指定失败的回调系统会默认指定-reason"><a class="anchor" href="#6promise异常传穿透如果再then中没有指定失败的回调系统会默认指定-reason">#</a> 6.promise 异常传 / 穿透（如果再 then 中没有指定失败的回调，系统会默认指定 reason =&gt;</h2><h2 id="7中断promise链-当使用promise的then链式调用时在中间中断不再调用后面的回调函数"><a class="anchor" href="#7中断promise链-当使用promise的then链式调用时在中间中断不再调用后面的回调函数">#</a> 7. 中断 promise 链（ 当使用 promise 的 then 链式调用时，在中间中断，不再调用后面的回调函数）</h2><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/*</pre></td></tr><tr><td data-num="2"></td><td><pre>        6.promise 异常传 / 穿透（如果再 then 中没有指定失败的回调，系统会默认指定 reason => &#123;throw reason&#125;</pre></td></tr><tr><td data-num="3"></td><td><pre>            （1 当使用 promise 的 hten 链式调用时，可以再最后指定失败的问题</pre></td></tr><tr><td data-num="4"></td><td><pre>            （2 前面任何操作出了异常，都会传到最后失败的回调中处理</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>        7. 中断 promise 链（ 当使用 promise 的 then 链式调用时，在中间中断，不再调用后面的回调函数）</pre></td></tr><tr><td data-num="7"></td><td><pre>            办法：在回调函数中返回一个 pending 状态的 promise 对象</pre></td></tr><tr><td data-num="8"></td><td><pre>    */</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token function">reject</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'成功回调'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>            <span class="token keyword">return</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token comment">// 默认：，reason => &#123;throw reason&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'成功回调'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token keyword">return</span> <span class="token number">3</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token comment">// 默认：，reason => &#123;throw reason&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'成功回调'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            <span class="token keyword">return</span> <span class="token number">4</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token comment">// 默认：，reason => &#123;throw reason&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token parameter">reason</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'最后指定的失败回调'</span><span class="token punctuation">,</span> reason<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>            <span class="token keyword">return</span> <span class="token number">5</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'成功回调'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token comment">// 返回一个未指定状态的 promise 对象来中断后面的回调</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'被中断的回调'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre>            </pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://yoursite.com/categories/javascript/"/>
    
    
      <category term="promise" scheme="http://yoursite.com/tags/promise/"/>
    
  </entry>
  
  <entry>
    <title>Promise的基本使用</title>
    <link href="http://yoursite.com/2020/11/16/Promise2020-11-16/"/>
    <id>http://yoursite.com/2020/11/16/Promise2020-11-16/</id>
    <published>2020-11-16T06:51:24.329Z</published>
    <updated>2020-11-16T06:57:48.836Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//promise 主要是为了解决异步函数嵌套造成回调地狱的问题</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token comment">//1. 创建一个新的 promise 对象</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span><span class="token comment">// 执行器</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token comment">// 执行异步任务</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>            <span class="token keyword">const</span> time <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>time <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>                <span class="token comment">// 如果成功了，调用 resolve（value）</span></pre></td></tr><tr><td data-num="9"></td><td><pre>                <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'成功了'</span><span class="token operator">+</span> time<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>                <span class="token comment">// 失败了，调用 reject（reason）</span></pre></td></tr><tr><td data-num="12"></td><td><pre>                <span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'失败了'</span> <span class="token operator">+</span> time<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token comment">//then 是异步的</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token comment">// 注意，实例调用 then () 会返回一个新的 promise 实例对象</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token parameter">value</span> <span class="token operator">=></span><span class="token punctuation">&#123;</span><span class="token comment">// 接收得到成功的 value 数据   onResolved</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'成功的回调'</span> <span class="token punctuation">,</span> value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token parameter">reason</span> <span class="token operator">=></span><span class="token punctuation">&#123;</span><span class="token comment">// 接收失败的 reason 数据    onRejected</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'失败的回调'</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token comment">// 简洁语法  Promise.resolve（）返回的是一个 promise 实例对象</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token keyword">const</span> p2 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'shibaid'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">const</span> p3 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'shibaid'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token keyword">const</span> p4 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre>    p2<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    p3<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">reason</span> <span class="token operator">=></span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p4<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://yoursite.com/categories/javascript/"/>
    
    
      <category term="promise" scheme="http://yoursite.com/tags/promise/"/>
    
  </entry>
  
  <entry>
    <title>日常随笔、一</title>
    <link href="http://yoursite.com/2020/11/14/2020-11-14-%E6%97%A5%E5%B8%B8/"/>
    <id>http://yoursite.com/2020/11/14/2020-11-14-%E6%97%A5%E5%B8%B8/</id>
    <published>2020-11-14T03:47:02.165Z</published>
    <updated>2020-11-29T12:42:34.286Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>这阵子经常想起养过的狗子，有些想念，估计现在都已经长成大狗了，有点遗憾，希望它们有人领养，不用再过以前流浪的生活。从小到大养了几次狗，可惜家里不同意，都没成。只能等到我能养活自己的时候了。狗是有真性情情的动物，不会嫌家贫，是靠谱的伙伴！</p><p class="gallery" data-height="220"><img data-src="https://tva4.sinaimg.cn/mw690/0085IK0fgy1gkomxv2imnj32o03k0137.jpg" alt="狗子 (1)" /><br /><img data-src="https://tvax3.sinaimg.cn/mw690/0085IK0fgy1gkok0r40avj32o03k0qbe.jpg" alt="IMG_20200111_110020_BURST1 (1)" /></p><br><p><span class="label info">更新于 2020-11-14</span></p><hr><br><br>这个世界有很多的恶意，不能因为伪救助多我们就再也不相信救助，不能因为我们遇人不淑就再也不相信感情，不能因为我们碰到了混蛋老板就再也不相信会有好领导，不能因为有太多的黑暗，就蒙蔽了发现美好的双眼，这不是成熟，是一种悲哀。<div align = 'right' >————老疯杨</div><p><span class="label info">更新于 2020-11-21</span></p><hr><br><br><div style="width:800px; height:450px"><iframe src="//player.bilibili.com/player.html?bvid=BV1ug4y187W7&cid=174509051&page=1&danmaku=0&as_wide=1&high_quality=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" width="100%" height="100%"></iframe></div><br><br><p>以前我朋友常跟我说：读那么多课外书也没见你作文有长进，有啥用？</p><p>谁会在意这事呢。</p><br><p><span class="label info">更新于 2020-11-29</span></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="日常随笔" scheme="http://yoursite.com/categories/diary/"/>
    
    
      <category term="随笔" scheme="http://yoursite.com/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>主题测试</title>
    <link href="http://yoursite.com/2020/11/09/test/"/>
    <id>http://yoursite.com/2020/11/09/test/</id>
    <published>2020-11-09T13:11:04.526Z</published>
    <updated>2020-11-29T12:14:56.487Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="测试一下"><a class="anchor" href="#测试一下">#</a> 测试一下</h1><p>audio: true</p><ul><li>title: 列表 1<br />list:<ul><li><span class="exturl" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvcGxheWxpc3Q/aWQ9NTE2MDE3NjY2OA==">https://music.163.com/#/playlist?id=5160176668</span></li></ul></li></ul><p>囧囧唧唧哦</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="测试" scheme="http://yoursite.com/categories/%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="测试" scheme="http://yoursite.com/tags/%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>nodejs异步封装——回调函数</title>
    <link href="http://yoursite.com/2020/10/18/2020-10-18.1/"/>
    <id>http://yoursite.com/2020/10/18/2020-10-18.1/</id>
    <published>2020-10-18T10:29:27.820Z</published>
    <updated>2020-11-08T09:17:22.367Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>代码描述</p><a id="more"></a><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/**</pre></td></tr><tr><td data-num="2"></td><td><pre> * 简化版</pre></td></tr><tr><td data-num="3"></td><td><pre> */</span></pre></td></tr><tr><td data-num="4"></td><td><pre>如果想要获取一个函数中异步操作返回的结果，则必须通过回调函数来获取（定时器是异步操作的）</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token operator">*</span>常用的异步操作</pre></td></tr><tr><td data-num="6"></td><td><pre> <span class="token operator">*</span>  setTimeout</pre></td></tr><tr><td data-num="7"></td><td><pre> <span class="token operator">*</span>  readFile</pre></td></tr><tr><td data-num="8"></td><td><pre> <span class="token operator">*</span>  writeFile</pre></td></tr><tr><td data-num="9"></td><td><pre> <span class="token operator">*</span>  ajax等</pre></td></tr><tr><td data-num="10"></td><td><pre> <span class="token operator">*</span>  这种情况一定要通过回调函数来获取异步操作结果</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span>y</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'aaa'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">'hello'</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">return</span> x <span class="token operator">+</span> y  <span class="token comment">// 无法返回到外部，所以只能通过回调函数返回，见下面例子</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'bbb'</span><span class="token punctuation">)</span> <span class="token comment">// 函数会执行完 console.log ('aaa') 后就执行 console.log ('bbb')，然后函数就就结束了，</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  <span class="token comment">// 返回默认的 undefined，不会去等待执行中间的定时器，最后才会去调用定时器 console.log (a)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>  </pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">// 执行结果为：  aaa bbb undefined hello 因为定时器是异步的，所以不会先执行，</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token comment">// 哪怕将调用时间改为 0，也会先执行后面代码，再执行异步函数</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token operator">*</span></pre></td></tr><tr><td data-num="30"></td><td><pre> <span class="token operator">*</span> </pre></td></tr><tr><td data-num="31"></td><td><pre> <span class="token operator">*</span> 理解回调函数的意义：</pre></td></tr><tr><td data-num="32"></td><td><pre> <span class="token operator">*</span>    可能新手可能会有的疑问：即使加了回调函数，异步操作还是照样异步操作，依然不会改变执行顺序，所以如果我们要对</pre></td></tr><tr><td data-num="33"></td><td><pre> <span class="token operator">*</span>                          异步操作的返回结果做处理的话，直接在异步函数里做处理就好了，有必要传到回调函数里再做处理吗？</pre></td></tr><tr><td data-num="34"></td><td><pre> <span class="token operator">*</span>    答疑：诚如上述所说，不用回调函数我们也能对异步操作结果进行处理，但是这样就达不到模块化封装函数的意义了，如果不用</pre></td></tr><tr><td data-num="35"></td><td><pre> <span class="token operator">*</span>          回调函数，直接在异步函数中处理要需要返回的结果，那么会使得整个函数十分臃肿，杂乱，可读性不高，不好维护，效率不行，</pre></td></tr><tr><td data-num="36"></td><td><pre> <span class="token operator">*</span>          所以要用回调函数的方式将异步函数结果返回到外部再进行处理，达到高内聚低耦合的模块编程的目的。</pre></td></tr><tr><td data-num="37"></td><td><pre> <span class="token operator">*</span>                        </pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre>  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token string">'hello'</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token function">callback</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="44"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>如果想要获取一个函数中异步操作的结果，则必须通过回调函数来获取（定时器是异步操作的）</pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="50"></td><td><pre></pre></td></tr><tr><td data-num="51"></td><td><pre></pre></td></tr><tr><td data-num="52"></td><td><pre></pre></td></tr><tr><td data-num="53"></td><td><pre></pre></td></tr><tr><td data-num="54"></td><td><pre>原文件</pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>  <span class="token keyword">var</span> <span class="token function-variable function">callback</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="57"></td><td><pre></pre></td></tr><tr><td data-num="58"></td><td><pre>  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>    <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token string">'hello'</span></pre></td></tr><tr><td data-num="60"></td><td><pre>    <span class="token keyword">return</span> data</pre></td></tr><tr><td data-num="61"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="62"></td><td><pre></pre></td></tr><tr><td data-num="63"></td><td><pre>  <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token string">'默认数据'</span></pre></td></tr><tr><td data-num="64"></td><td><pre>  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>    data <span class="token operator">=</span> <span class="token string">'hello'</span></pre></td></tr><tr><td data-num="66"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="67"></td><td><pre>  <span class="token keyword">return</span> data</pre></td></tr><tr><td data-num="68"></td><td><pre></pre></td></tr><tr><td data-num="69"></td><td><pre>  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>    <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token string">'hello'</span></pre></td></tr><tr><td data-num="71"></td><td><pre>    <span class="token function">callback</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="72"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="73"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="74"></td><td><pre></pre></td></tr><tr><td data-num="75"></td><td><pre><span class="token comment">// 调用 fn ，得到内部的 data</span></pre></td></tr><tr><td data-num="76"></td><td><pre><span class="token comment">// console.log(fn())</span></pre></td></tr><tr><td data-num="77"></td><td><pre></pre></td></tr><tr><td data-num="78"></td><td><pre><span class="token comment">// 如果需要获取一个函数中异步操作的结果，则必须通过回调函数来获取</span></pre></td></tr><tr><td data-num="79"></td><td><pre><span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="80"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="81"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="82"></td><td><pre></pre></td></tr><tr><td data-num="83"></td><td><pre></pre></td></tr><tr><td data-num="84"></td><td><pre><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="85"></td><td><pre>  <span class="token comment">// var callback = function (data) &#123; console.log(data) &#125;</span></pre></td></tr><tr><td data-num="86"></td><td><pre></pre></td></tr><tr><td data-num="87"></td><td><pre>  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="88"></td><td><pre>    <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token string">'hello'</span></pre></td></tr><tr><td data-num="89"></td><td><pre>    <span class="token function">callback</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="90"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="91"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="92"></td><td><pre></pre></td></tr><tr><td data-num="93"></td><td><pre><span class="token comment">// 如果需要获取一个函数中异步操作的结果，则必须通过回调函数来获取</span></pre></td></tr><tr><td data-num="94"></td><td><pre><span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="95"></td><td><pre>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="96"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="97"></td><td><pre></pre></td></tr><tr><td data-num="98"></td><td><pre>$<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'dsadsadsa?foo=bar'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="99"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="100"></td><td><pre></pre></td></tr><tr><td data-num="101"></td><td><pre>$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="102"></td><td><pre>  url<span class="token operator">:</span> <span class="token string">'dsadsa'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="103"></td><td><pre>  type<span class="token operator">:</span> <span class="token string">'get'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="104"></td><td><pre>  data<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="105"></td><td><pre>    foo<span class="token operator">:</span> <span class="token string">'bar'</span></pre></td></tr><tr><td data-num="106"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="107"></td><td><pre>  <span class="token comment">// 使用者只负责传递，封装这需要去调用</span></pre></td></tr><tr><td data-num="108"></td><td><pre>  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="109"></td><td><pre>    </pre></td></tr><tr><td data-num="110"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="111"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="112"></td><td><pre></pre></td></tr><tr><td data-num="113"></td><td><pre><span class="token keyword">function</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="114"></td><td><pre>  options<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="115"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;代码描述&lt;/p&gt;
    
    </summary>
    
    
      <category term="nodejs" scheme="http://yoursite.com/categories/nodejs/"/>
    
    
      <category term="nodejs异步封装" scheme="http://yoursite.com/tags/nodejs%E5%BC%82%E6%AD%A5%E5%B0%81%E8%A3%85/"/>
    
  </entry>
  
  <entry>
    <title>阿里图标-symbolweb应用</title>
    <link href="http://yoursite.com/2020/08/20/2020-08-20.1/"/>
    <id>http://yoursite.com/2020/08/20/2020-08-20.1/</id>
    <published>2020-08-20T03:32:32.534Z</published>
    <updated>2020-11-08T09:31:46.115Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>代码笔记</p><a id="more"></a><h2 id="symbol引用"><a class="anchor" href="#symbol引用">#</a> symbol 引用</h2><p>这是一种全新的使用方式，应该说这才是未来的主流，也是平台目前推荐的用法。相关介绍可以参考这篇<span class="exturl" data-url="aHR0cHM6Ly93d3cuaWNvbmZvbnQuY24vaGVscC9kZXRhaWw/c3BtPWEzMTN4Ljc3ODEwNjkuMTk5ODkxMDQxOS4xNyZhbXA7aGVscHR5cGU9Y29kZQ==">文章</span> 这种用法其实是做了一个 svg 的集合，与上面两种相比具有如下特点：</p><ul><li>支持多色图标了，不再受单色限制。</li><li>通过一些技巧，支持像字体那样，通过 <code>font-size</code> , <code>color</code>  来调整样式。</li><li>兼容性较差，支持 ie9+, 及现代浏览器。</li><li>浏览器渲染 svg 的性能一般，还不如 png。</li></ul><p>使用步骤如下：</p><h3 id="第一步拷贝项目下面生成的symbol代码并引入如"><a class="anchor" href="#第一步拷贝项目下面生成的symbol代码并引入如">#</a> 第一步：拷贝项目下面生成的 symbol 代码并引入，如：</h3><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"//at.alicdn.com/t/font_1924059_pf56q7god8h.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></pre></td></tr></table></figure><h3 id="第二步加入通用css代码引入一次就行"><a class="anchor" href="#第二步加入通用css代码引入一次就行">#</a> 第二步：加入通用 css 代码（引入一次就行）：</h3><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">&lt;</span>style type<span class="token operator">=</span><span class="token string">"text/css"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token punctuation">.</span>icon <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>       width<span class="token operator">:</span> <span class="token number">1</span>em<span class="token punctuation">;</span> height<span class="token operator">:</span> <span class="token number">1</span>em<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>       vertical<span class="token operator">-</span>align<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">0.15</span>em<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>       fill<span class="token operator">:</span> currentColor<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>       overflow<span class="token operator">:</span> hidden<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">></span></pre></td></tr></table></figure><h3 id="第三步挑选相应图标并获取类名应用于页面"><a class="anchor" href="#第三步挑选相应图标并获取类名应用于页面">#</a> 第三步：挑选相应图标并获取类名，应用于页面：</h3><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">&lt;</span>svg <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"icon"</span> aria<span class="token operator">-</span>hidden<span class="token operator">=</span><span class="token string">"true"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token operator">&lt;</span>use xlink<span class="token operator">:</span>href<span class="token operator">=</span><span class="token string">"#icon-xxx"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>use<span class="token operator">></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>svg<span class="token operator">></span></pre></td></tr></table></figure><p><strong>如：</strong></p><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">&lt;</span>svg <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"icon"</span> aria<span class="token operator">-</span>hidden<span class="token operator">=</span><span class="token string">"true"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="2"></td><td><pre>   <span class="token operator">&lt;</span>use xlink<span class="token operator">:</span>href<span class="token operator">=</span><span class="token string">"#icon-zhifeiji1"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>use<span class="token operator">></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>svg<span class="token operator">></span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;代码笔记&lt;/p&gt;
    
    </summary>
    
    
      <category term="Iconfont" scheme="http://yoursite.com/categories/Iconfont/"/>
    
    
      <category term="Iconfont" scheme="http://yoursite.com/tags/Iconfont/"/>
    
  </entry>
  
  <entry>
    <title>数据结构：队列</title>
    <link href="http://yoursite.com/2020/08/18/2020-08-18.2/"/>
    <id>http://yoursite.com/2020/08/18/2020-08-18.2/</id>
    <published>2020-08-18T13:32:52.536Z</published>
    <updated>2020-11-15T14:37:11.360Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><a id="more"></a><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span> </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdlib.h></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string.h></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">//#ifndef SEQQUEUE_H</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">//#define SEQQUEUE_H</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token expression">MAX_SIZE <span class="token number">1024</span></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">// 顺序队列数组结构 </span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">//typedef 的作用：使声明变量时可以直接 SeqQueue seq1; 使 SeqQueue 相当于 struct SEQQUEUE </span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">SEQQUEUE</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">void</span><span class="token operator">*</span> data<span class="token punctuation">[</span>MAX_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">int</span> size<span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span>SeqQueue<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">// 初始化</span></pre></td></tr><tr><td data-num="17"></td><td><pre>SeqQueue<span class="token operator">*</span> <span class="token function">Init_SeqQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>SeqQueue<span class="token operator">*</span> queue <span class="token operator">=</span> <span class="token punctuation">(</span>SeqQueue<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>SeqQueue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>MAX_SIZE<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>queue<span class="token operator">-></span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>queue<span class="token operator">-></span>size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">return</span> queue<span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token comment">// 入队</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">void</span> <span class="token function">Push_SeqQueue</span><span class="token punctuation">(</span>SeqQueue<span class="token operator">*</span> queue<span class="token punctuation">,</span><span class="token keyword">void</span><span class="token operator">*</span> data<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token comment">// 数组左边当做对头</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span>queue <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span>data <span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span>queue<span class="token operator">-></span>size <span class="token operator">==</span> MAX_SIZE<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>queue<span class="token operator">-></span>data<span class="token punctuation">[</span>queue<span class="token operator">-></span>size<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>queue<span class="token operator">-></span>size<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token comment">// 返回对头元素</span></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token keyword">void</span><span class="token operator">*</span> <span class="token function">Front_SeqQueue</span><span class="token punctuation">(</span>SeqQueue<span class="token operator">*</span> queue<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span>queue <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span>queue<span class="token operator">-></span>size <span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token keyword">return</span> queue<span class="token operator">-></span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token punctuation">&#125;</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre></pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token comment">// 出队</span></pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token keyword">void</span> <span class="token function">Pop_SeqQueue</span><span class="token punctuation">(</span>SeqQueue<span class="token operator">*</span> queue<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="59"></td><td><pre></pre></td></tr><tr><td data-num="60"></td><td><pre></pre></td></tr><tr><td data-num="61"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span>queue <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="62"></td><td><pre><span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="63"></td><td><pre><span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="64"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span>queue<span class="token operator">-></span>size<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="65"></td><td><pre><span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="67"></td><td><pre><span class="token comment">// 需要移动元素</span></pre></td></tr><tr><td data-num="68"></td><td><pre><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>queue<span class="token operator">-></span>size<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>queue<span class="token operator">-></span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> queue<span class="token operator">-></span>data<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="70"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>queue<span class="token operator">-></span>size<span class="token operator">--</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="72"></td><td><pre></pre></td></tr><tr><td data-num="73"></td><td><pre><span class="token punctuation">&#125;</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="74"></td><td><pre></pre></td></tr><tr><td data-num="75"></td><td><pre><span class="token comment">// 返回队尾元素</span></pre></td></tr><tr><td data-num="76"></td><td><pre><span class="token keyword">void</span><span class="token operator">*</span> <span class="token function">Back_SeqQueue</span><span class="token punctuation">(</span>SeqQueue<span class="token operator">*</span> queue<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="77"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span>queue<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="78"></td><td><pre><span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="79"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="80"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span>queue<span class="token operator">-></span>size <span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="81"></td><td><pre><span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="82"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="83"></td><td><pre></pre></td></tr><tr><td data-num="84"></td><td><pre><span class="token keyword">return</span> queue<span class="token operator">-></span>data<span class="token punctuation">[</span>queue<span class="token operator">-></span>size<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="85"></td><td><pre><span class="token punctuation">&#125;</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="86"></td><td><pre></pre></td></tr><tr><td data-num="87"></td><td><pre></pre></td></tr><tr><td data-num="88"></td><td><pre><span class="token comment">// 返回大小</span></pre></td></tr><tr><td data-num="89"></td><td><pre><span class="token keyword">int</span> <span class="token function">Size_SeqQueue</span><span class="token punctuation">(</span>SeqQueue<span class="token operator">*</span> queue<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="90"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span>queue <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="91"></td><td><pre><span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="92"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="93"></td><td><pre><span class="token keyword">return</span> queue<span class="token operator">-></span>size<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="94"></td><td><pre><span class="token punctuation">&#125;</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="95"></td><td><pre></pre></td></tr><tr><td data-num="96"></td><td><pre><span class="token comment">// 清空队列</span></pre></td></tr><tr><td data-num="97"></td><td><pre><span class="token keyword">void</span> <span class="token function">Clear_SeqQueue</span><span class="token punctuation">(</span>SeqQueue<span class="token operator">*</span> queue<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="98"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span>queue <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="99"></td><td><pre><span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="100"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="101"></td><td><pre>queue<span class="token operator">-></span>size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="102"></td><td><pre></pre></td></tr><tr><td data-num="103"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="104"></td><td><pre></pre></td></tr><tr><td data-num="105"></td><td><pre><span class="token comment">// 销毁队列</span></pre></td></tr><tr><td data-num="106"></td><td><pre><span class="token keyword">void</span> <span class="token function">FreeSpace_SeqQueue</span><span class="token punctuation">(</span>SeqQueue<span class="token operator">*</span> queue<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="107"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span>queue <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="108"></td><td><pre><span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="109"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="110"></td><td><pre><span class="token function">free</span><span class="token punctuation">(</span>queue<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="111"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="112"></td><td><pre> </pre></td></tr><tr><td data-num="113"></td><td><pre> </pre></td></tr><tr><td data-num="114"></td><td><pre><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">PERSON</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="115"></td><td><pre><span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="116"></td><td><pre><span class="token keyword">int</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="117"></td><td><pre><span class="token punctuation">&#125;</span>Person<span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="118"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="119"></td><td><pre></pre></td></tr><tr><td data-num="120"></td><td><pre><span class="token comment">// 创建队列</span></pre></td></tr><tr><td data-num="121"></td><td><pre>SeqQueue<span class="token operator">*</span> queue <span class="token operator">=</span> <span class="token function">Init_SeqQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="122"></td><td><pre></pre></td></tr><tr><td data-num="123"></td><td><pre><span class="token comment">// 创建数据</span></pre></td></tr><tr><td data-num="124"></td><td><pre> Person p1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"aaa"</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="125"></td><td><pre> Person p2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"bbb"</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="126"></td><td><pre> Person p3 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"ccc"</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="127"></td><td><pre> Person p4 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"ddd"</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="128"></td><td><pre> Person p5 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"eee"</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="129"></td><td><pre> </pre></td></tr><tr><td data-num="130"></td><td><pre> <span class="token comment">// 数据入队列</span></pre></td></tr><tr><td data-num="131"></td><td><pre> <span class="token function">Push_SeqQueue</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span><span class="token operator">&amp;</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="132"></td><td><pre> <span class="token function">Push_SeqQueue</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span><span class="token operator">&amp;</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="133"></td><td><pre> <span class="token function">Push_SeqQueue</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span><span class="token operator">&amp;</span>p3<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="134"></td><td><pre> <span class="token function">Push_SeqQueue</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span><span class="token operator">&amp;</span>p4<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="135"></td><td><pre> <span class="token function">Push_SeqQueue</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span><span class="token operator">&amp;</span>p5<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="136"></td><td><pre> </pre></td></tr><tr><td data-num="137"></td><td><pre> </pre></td></tr><tr><td data-num="138"></td><td><pre> <span class="token comment">// 输出队尾元素</span></pre></td></tr><tr><td data-num="139"></td><td><pre> Person<span class="token operator">*</span> backPerson <span class="token operator">=</span> <span class="token punctuation">(</span>Person<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">Back_SeqQueue</span><span class="token punctuation">(</span>queue<span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="140"></td><td><pre> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Name:%s Age:%d\n"</span><span class="token punctuation">,</span>backPerson<span class="token operator">-></span>name<span class="token punctuation">,</span>backPerson<span class="token operator">-></span>age<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="141"></td><td><pre> </pre></td></tr><tr><td data-num="142"></td><td><pre> <span class="token comment">// 输出</span></pre></td></tr><tr><td data-num="143"></td><td><pre> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">Size_SeqQueue</span><span class="token punctuation">(</span>queue<span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="144"></td><td><pre> <span class="token comment">// 取出队头元素 </span></pre></td></tr><tr><td data-num="145"></td><td><pre> Person<span class="token operator">*</span> p <span class="token operator">=</span> <span class="token punctuation">(</span>Person<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">Front_SeqQueue</span><span class="token punctuation">(</span>queue<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="146"></td><td><pre> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Name:%s Age:%d\n"</span><span class="token punctuation">,</span>p<span class="token operator">-></span>name<span class="token punctuation">,</span>p<span class="token operator">-></span>age<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="147"></td><td><pre> <span class="token comment">// 从队头弹出元素</span></pre></td></tr><tr><td data-num="148"></td><td><pre><span class="token function">Pop_SeqQueue</span><span class="token punctuation">(</span>queue<span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="149"></td><td><pre> <span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="150"></td><td><pre> </pre></td></tr><tr><td data-num="151"></td><td><pre></pre></td></tr><tr><td data-num="152"></td><td><pre><span class="token function">FreeSpace_SeqQueue</span><span class="token punctuation">(</span>queue<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="153"></td><td><pre></pre></td></tr><tr><td data-num="154"></td><td><pre> </pre></td></tr><tr><td data-num="155"></td><td><pre> </pre></td></tr><tr><td data-num="156"></td><td><pre> </pre></td></tr><tr><td data-num="157"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="数据结构" scheme="http://yoursite.com/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    
      <category term="队列" scheme="http://yoursite.com/tags/%E9%98%9F%E5%88%97/"/>
    
  </entry>
  
  <entry>
    <title>C语言笔记：.和-&gt;的区别和typedef使用</title>
    <link href="http://yoursite.com/2020/08/18/2020-08-18.1/"/>
    <id>http://yoursite.com/2020/08/18/2020-08-18.1/</id>
    <published>2020-08-18T11:15:12.789Z</published>
    <updated>2020-11-12T16:01:55.831Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>代码笔记</p><a id="more"></a><h1 id="使用结构体时常用到的运算符与箭头运算符-的区别"><a class="anchor" href="#使用结构体时常用到的运算符与箭头运算符-的区别">#</a> 使用结构体时常用到的。运算符与箭头运算符 -&gt; 的区别</h1><h2 id="点运算符左边是一个结构体-左边是一个结构体指针"><a class="anchor" href="#点运算符左边是一个结构体-左边是一个结构体指针">#</a> 点运算符（.）左边是一个结构体，-&gt; 左边是一个结构体指针</h2><p><strong>例如：</strong></p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">PERSON</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">int</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span>Per<span class="token punctuation">,</span>Person<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 因为有 typedef，于是在声明变量的时候就可：Per stu1; 或者：Person stu2;(Per 和 Person 同时为 Student 的别名)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// 否则只能用 struct PERSON 变量名；来声明</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">//b->age=17 === (*b).age = 17; 为了使用方便和直观，c 语言允许用 b->age 代替 (*b).age</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    </pre></td></tr><tr><td data-num="11"></td><td><pre>Per a<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"Jack"</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>Person<span class="token operator">*</span> b<span class="token operator">=</span><span class="token operator">&amp;</span>a<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a:%s,%d\n"</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>name<span class="token punctuation">,</span>a<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//Jack 20</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// 巨坑：注意这里 a.name="jack", 和 b->name="Jack" 等都是不可以的，</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">// 不能单独给字符串数组赋值，可以在定义的时候就赋值，或者用</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">//strcpy (数组名，“...”) 方法赋值 </span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">//b->name = "Bob"; 报错 </span></pre></td></tr><tr><td data-num="18"></td><td><pre>b<span class="token operator">-></span>age <span class="token operator">=</span> <span class="token number">17</span><span class="token punctuation">;</span>     <span class="token comment">//(*b).age = 17;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a:%s,%d\nb:%s,%d"</span><span class="token punctuation">,</span>a<span class="token punctuation">.</span>name<span class="token punctuation">,</span>a<span class="token punctuation">.</span>age<span class="token punctuation">,</span>b<span class="token operator">-></span>name<span class="token punctuation">,</span>b<span class="token operator">-></span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Jack 17  Jack  17</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;代码笔记&lt;/p&gt;
    
    </summary>
    
    
      <category term="C程序设计" scheme="http://yoursite.com/categories/C/"/>
    
    
      <category term="-&gt; 结构体指针" scheme="http://yoursite.com/tags/%E7%BB%93%E6%9E%84%E4%BD%93%E6%8C%87%E9%92%88/"/>
    
  </entry>
  
  <entry>
    <title>C语言笔记：函数指针(函数传递)</title>
    <link href="http://yoursite.com/2020/08/15/2020-08-15.2/"/>
    <id>http://yoursite.com/2020/08/15/2020-08-15.2/</id>
    <published>2020-08-15T06:14:10.150Z</published>
    <updated>2020-11-12T16:01:36.394Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>代码笔记</p><a id="more"></a><p><strong>重要理解：</strong></p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 函数声明 </span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">double</span> <span class="token function">getAverage</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>arr<span class="token punctuation">,</span><span class="token keyword">int</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">double</span> <span class="token function">getAverage2</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>arr<span class="token punctuation">,</span><span class="token keyword">int</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">//int *intt;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">//int num = 4;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">//intt = &amp;num</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">//intt 是地址，*intt 是值 </span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">// 千万注意：arr 是地址，*arr 和 arr [i] 是值 </span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">int</span> balance<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">double</span> avg<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>avg <span class="token operator">=</span> <span class="token function">getAverage</span><span class="token punctuation">(</span>balance<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">//avg = getAverage2(balance,5);</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%f"</span><span class="token punctuation">,</span>avg<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span>balance<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//1 2 3 4</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment">// 函数 1 </span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">double</span> <span class="token function">getAverage</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>arr<span class="token punctuation">,</span><span class="token keyword">int</span> size<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token keyword">int</span> i<span class="token punctuation">,</span>sum <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">double</span> avg<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>size<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token punctuation">&#123;</span><span class="token comment">// 不可 * arr [i],* 取值符，取值符与地址搭配得到值，arr 是个地址值，所以 * arr 可以，但 arr [i] 是个数值，所以不行</span></pre></td></tr><tr><td data-num="32"></td><td><pre>sum <span class="token operator">+=</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 千万注意：arr 是地址，*arr 和 arr [i] 是值</span></pre></td></tr><tr><td data-num="33"></td><td><pre>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token comment">//printf("%d\n",arr[i]);</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>avg <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>sum<span class="token operator">/</span>size<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">return</span> avg<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token comment">// 函数 2 </span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token keyword">double</span> <span class="token function">getAverage2</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>arr<span class="token punctuation">,</span><span class="token keyword">int</span> size<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token keyword">int</span> i<span class="token punctuation">,</span>sum <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token keyword">double</span> avg<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>size<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token punctuation">&#123;</span><span class="token comment">// 不可 * arr [i],* 取值符，取值符与地址搭配得到值，arr 是个地址值，所以 * arr 可以，但 arr [i] 是个数值，所以不行</span></pre></td></tr><tr><td data-num="47"></td><td><pre>sum <span class="token operator">+=</span><span class="token operator">*</span>arr<span class="token punctuation">;</span><span class="token comment">// 千万注意：arr 是地址，*arr 和 arr [i] 是值</span></pre></td></tr><tr><td data-num="48"></td><td><pre>arr<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>avg <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>sum<span class="token operator">/</span>size<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token keyword">return</span> avg<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><strong>结构体值传递：</strong></p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 定义 Dog 结构体</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">struct</span> <span class="token class-name">Dog</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">int</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">double</span> weight<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">// 函数声明 </span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">say</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Dog</span> dog<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">//say 函数定义，返回字符串，信息中包含所有成员值 </span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">say</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Dog</span> dog<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">// 为防止局部变量被销毁，要用 static 修饰</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">static</span> <span class="token keyword">char</span> info<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>dog<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"小花"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token function">sprintf</span><span class="token punctuation">(</span>info<span class="token punctuation">,</span><span class="token string">"name=%s age=%d weight=%.2f"</span><span class="token punctuation">,</span>dog<span class="token punctuation">.</span>name<span class="token punctuation">,</span>dog<span class="token punctuation">.</span>age<span class="token punctuation">,</span>dog<span class="token punctuation">.</span>weight<span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">return</span> info<span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="24"></td><td><pre> </pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">// 定义结构体</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">struct</span> <span class="token class-name">Dog</span> dog<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">char</span><span class="token operator">*</span> info <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>dog<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"小黄"</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="32"></td><td><pre>dog<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>dog<span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">3.4</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>info <span class="token operator">=</span> <span class="token function">say</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 结构体变量默认是值传递</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n小狗信息=%s"</span><span class="token punctuation">,</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n main 小狗名字=%s"</span><span class="token punctuation">,</span>dog<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><strong>传递结构体指针：</strong></p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string.h></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">/*</pre></td></tr><tr><td data-num="4"></td><td><pre>1. 一个景区根据有人的年龄收取不同价格的门票</pre></td></tr><tr><td data-num="5"></td><td><pre>2. 请编写有人结构体（Visitor），根据不同年龄收费不同</pre></td></tr><tr><td data-num="6"></td><td><pre>3. 规则：年龄 > 20 门票 20 元，其余免费</pre></td></tr><tr><td data-num="7"></td><td><pre>4. 可以循环从控制台输入名字和年龄，打印门票收费情况，如果名字输入 n，则退出程序</pre></td></tr><tr><td data-num="8"></td><td><pre> </pre></td></tr><tr><td data-num="9"></td><td><pre>*/</span> </pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">// 定义结构体</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">struct</span> <span class="token class-name">Visitor</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">int</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">double</span> pay<span class="token punctuation">;</span> <span class="token comment">// 应付票价 </span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">// 编写函数处理数据</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment">// 说明：结构体是值传递，会赋值一份传递过去，效率较低</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">// 为了提高效率，直接传递指针</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">void</span> <span class="token function">ticket</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">Visitor</span><span class="token operator">*</span> visitor<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">// 注意：visitor 是结构体地址，*visitor 才是值 </span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>visitor<span class="token punctuation">)</span><span class="token punctuation">.</span>age<span class="token operator">>=</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">(</span><span class="token operator">*</span>visitor<span class="token punctuation">)</span><span class="token punctuation">.</span>pay <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">(</span><span class="token operator">*</span>visitor<span class="token punctuation">)</span><span class="token punctuation">.</span>pay <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token comment">// 创建结构体变量</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">struct</span> <span class="token class-name">Visitor</span> visitor<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token comment">// 循环输入名字和年龄</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n注意：姓名输入n则退出程序"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n请输入游客名字："</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span>visitor<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token comment">// 判断如果名字输入为 n 就退出，strcmp ("n",visitor.name) 比较相等的话会返回 0 </span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strcmp</span><span class="token punctuation">(</span><span class="token string">"n"</span><span class="token punctuation">,</span>visitor<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n退出程序"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="46"></td><td><pre> </pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n请输入游客年龄："</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>visitor<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre> </pre></td></tr><tr><td data-num="50"></td><td><pre> <span class="token comment">// 调用函数 ticket 函数</span></pre></td></tr><tr><td data-num="51"></td><td><pre> <span class="token function">ticket</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>visitor<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n姓名：%s 年龄：%d  票价：%f"</span><span class="token punctuation">,</span>visitor<span class="token punctuation">.</span>name<span class="token punctuation">,</span>visitor<span class="token punctuation">.</span>age<span class="token punctuation">,</span>visitor<span class="token punctuation">.</span>pay<span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;代码笔记&lt;/p&gt;
    
    </summary>
    
    
      <category term="C程序设计" scheme="http://yoursite.com/categories/C/"/>
    
    
      <category term="函数指针" scheme="http://yoursite.com/tags/%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88/"/>
    
  </entry>
  
  <entry>
    <title>C语言笔记：字符串指针输出疑解</title>
    <link href="http://yoursite.com/2020/08/15/2020-08-15.1/"/>
    <id>http://yoursite.com/2020/08/15/2020-08-15.1/</id>
    <published>2020-08-15T06:04:14.825Z</published>
    <updated>2020-11-08T09:27:17.318Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>代码笔记</p><a id="more"></a><p><img data-src="https://cdn.jsdelivr.net/gh/lanQing-Song/blogimages/QQ%E6%88%AA%E5%9B%BE20200810214422.png" alt="" /></p><p>又如：</p><figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 字符串赋值给指针变量时，是将字符串的首个字符地址赋给</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">char</span><span class="token operator">*</span> string <span class="token operator">=</span> <span class="token string">"i am a student"</span><span class="token punctuation">;</span><span class="token comment">// 或 char* string; string = "i am a student"</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 理解：为什么不是 * string？</span></pre></td></tr></table></figure><p><strong>解答：</strong></p><p>% s 是输出字符串时所用的格式符，在输出项中给出字符指针变量名 string，** 则系统会输出 string 所指向的字符串第一个字符，然后自动使 string+1，使之指向下一个字符，再输出该字符...... 如此直到遇到字符串结束标志‘\0’为止。** 注意：再内存中，字符串最后被自动加了 '\0'。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;代码笔记&lt;/p&gt;
    
    </summary>
    
    
      <category term="C语言" scheme="http://yoursite.com/categories/C%E8%AF%AD%E8%A8%80/"/>
    
    
      <category term="字符串指针" scheme="http://yoursite.com/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8C%87%E9%92%88/"/>
    
  </entry>
  
  <entry>
    <title>CSS笔记：常用知识点</title>
    <link href="http://yoursite.com/2020/08/07/2020-08-07.3/"/>
    <id>http://yoursite.com/2020/08/07/2020-08-07.3/</id>
    <published>2020-08-07T14:10:38.626Z</published>
    <updated>2020-11-12T15:54:33.207Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>代码笔记</p><a id="more"></a><p>参考文章：<span class="exturl" data-url="aHR0cHM6Ly9qdWVqaW4uaW0vcG9zdC82ODQ0OTAzOTYyNTI5NzU5MjM5">https://juejin.im/post/6844903962529759239</span></p><h1 id="一-元素水平居中的方案"><a class="anchor" href="#一-元素水平居中的方案">#</a> 一、元素水平居中的方案</h1><h2 id="1-对于行内元素text-aligncenter"><a class="anchor" href="#1-对于行内元素text-aligncenter">#</a> 1、对于<strong>行内元素</strong>： <code>text-align:center;</code></h2><h2 id="2-对于确定宽度的块级元素"><a class="anchor" href="#2-对于确定宽度的块级元素">#</a> 2、对于确定宽度的块级元素：</h2><ul><li>(1)) 用 width 和 margin 实现： <code>margin:0  auto;</code></li><li>(2) 子绝父相，再给子元素 <code>left:50%;margin-left:-自身宽度一半</code></li></ul><h2 id="3-对于宽度无知的块级元素"><a class="anchor" href="#3-对于宽度无知的块级元素">#</a> 3、对于宽度无知的块级元素</h2><ul><li>(1)) 将该块级元素 <code>display:table;margin:0 auto;</code></li><li>(2)) 将子元素 <code>display:inline-block;</code> , 再给父元素添加 <code>text-align:center</code></li><li>(3) 子绝父相，再给子元素来 <code>left:50%;  transform:translateX(-50%)(移动自身50%)</code></li><li>(4) 给父元素 <code>display:flex;  justify-content:center</code> , 子元素自然居中</li></ul><h1 id="二-垂直居中"><a class="anchor" href="#二-垂直居中">#</a> 二、垂直居中</h1><ul><li>(1) 父元素高度不写死，自接给个上下内边距让子元素居中</li><li>(2) 父子都已确定高度，再子绝父相，再给子元素 <code>top:50%;transform：translateX(-50%)</code>  注意父元素高度要确定，不然子元素绝对定位脱离文档流，导致父元素高度坍塌</li><li>(3) 给父元素 <code>display:flex; </code> , 子元素 <code>margin：auto（水平垂直居中）margin：auto 0(垂直居中)</code></li><li>(4) table 标签内的 td 标签里的内容默认垂直居中，缺点是子元素会占满整个父元素。</li><li>(5) 将 div 改造成表单，给父元素添加 <code>display:table</code>  子元素 <code>display:table-cell  vertical-align:middle</code> , 这样子元素的内容物就会垂直居中，缺点是子元素会占满整个父元素。</li></ul><h1 id="三-选择器分类"><a class="anchor" href="#三-选择器分类">#</a> 三、选择器分类</h1><figure class="highlight css"><figcaption data-lang="CSS"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token important">!important</span>>行内样式>ID选择器>类、伪类、属性>元素、伪元素>继承>通配符</pre></td></tr></table></figure><h2 id="通配符选择器"><a class="anchor" href="#通配符选择器">#</a> 通配符选择器</h2><figure class="highlight css"><figcaption data-lang="CSS"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token selector">*</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token property">margin</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token property">padding</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="标签元素选择器"><a class="anchor" href="#标签元素选择器">#</a> 标签（元素）选择器</h2><figure class="highlight css"><figcaption data-lang="CSS"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token selector">p</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token property">color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="类选择器"><a class="anchor" href="#类选择器">#</a> 类选择器</h2><figure class="highlight css"><figcaption data-lang="CSS"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token selector">.warning</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token property">color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="id选择器"><a class="anchor" href="#id选择器">#</a> ID 选择器</h2><figure class="highlight css"><figcaption data-lang="CSS"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token selector">#warning</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token property">color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="属性选择器"><a class="anchor" href="#属性选择器">#</a> 属性选择器</h2><blockquote><p>例子</p><table><thead><tr><th>a[src^=&quot;https&quot;]</th><th>选择其 src 属性值以 &quot;https&quot; 开头的每个 <a> 元素。</th></tr></thead><tbody><tr><td>[target]</td><td>选择带有 target 属性所有元素。</td></tr></tbody></table></blockquote><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">foo</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">foo</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>abc<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">foo</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>abc efj<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">foo</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>abcefj<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">foo</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>efjabc<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">foo</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ab<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><ul><li>[attribute（属性）]</li></ul><figure class="highlight css"><figcaption data-lang="CSS"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token selector">//选择所有带有foo属性的标签</pre></td></tr><tr><td data-num="2"></td><td><pre>[foo]</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token property">background-color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><ul><li>[attribute=value]</li></ul><figure class="highlight css"><figcaption data-lang="CSS"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token selector">//选择foo=abc的标签</pre></td></tr><tr><td data-num="2"></td><td><pre>[foo=value]</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token property">background-color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><ul><li>[attribute~=value]</li></ul><blockquote><p>选择 attribute 属性包含单词 value 的所有元素。</p></blockquote><ul><li>[attribute^=value]</li></ul><blockquote><p>选择其 attribute 属性值以 value 开头的所有元素</p></blockquote><ul><li>[attribute$=value]</li></ul><blockquote><p>选择 attribute 属性值以 value 结束的所有元素</p></blockquote><ul><li>[attribute*=value]</li></ul><blockquote><p>选择其 attribute 属性包含 value 子串的每个元素</p></blockquote><ul><li>[attribute|=value]</li></ul><blockquote><p>选择 attribute 属性值以 value 开头的所有元素</p></blockquote><h2 id="文档结构选择器"><a class="anchor" href="#文档结构选择器">#</a> 文档结构选择器</h2><table><thead><tr><th><a href="https://www.w3school.com.cn/cssref/selector_element_comma.asp"><em>element</em>,<em>element</em></a> 并集选择器</th><th>div,p</th><th>选择所有 <div> 元素和所有 <p> 元素。</th><th>1</th></tr></thead><tbody><tr><td><a href="https://www.w3school.com.cn/cssref/selector_element_element.asp"><em>element</em> <em>element</em></a> 后代选择器</td><td>div p</td><td>选择 <div> 元素内部的所有 <p> 元素。</td><td>1</td></tr><tr><td><a href="https://www.w3school.com.cn/cssref/selector_element_gt.asp"><em>element</em>&gt;<em>element</em></a> 子代选择器</td><td>div&gt;p</td><td>选择父元素为 <div> 元素的所有 <p> 元素。</td><td>2</td></tr><tr><td><a href="https://www.w3school.com.cn/cssref/selector_element_plus.asp"><em>element</em>+<em>element</em></a> 相邻兄弟选择器</td><td>div+p</td><td>选择紧接在 <div> 元素之后的所有 <p> 元素。</td><td>2</td></tr></tbody></table><h2 id="伪类选择器"><a class="anchor" href="#伪类选择器">#</a> 伪类选择器</h2><ul><li>：root 文档根元素伪类</li></ul><figure class="highlight css"><figcaption data-lang="CSS"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token selector">:root</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token property">background-color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><ul><li>:nth-child (n) 孩子选择器</li><li>:nth-of-type (n) 同类型的第 n 个选择器</li><li>element:fitst-child</li></ul><blockquote><p>选择属于父元素 element 的第一个子元素。 等同 :nth-child (1)</p></blockquote><ul><li><p>element:last-of-type</p></li><li><p>element:only-child</p></li></ul><blockquote><p>选择了父元素 element 唯一的子元素</p></blockquote><p>示例：</p><figure class="highlight css"><figcaption data-lang="CSS"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token selector">&lt;div></pre></td></tr><tr><td data-num="2"></td><td><pre>    &lt;h1>h1&lt;/h1></pre></td></tr><tr><td data-num="3"></td><td><pre>    &lt;p>p1&lt;/p></pre></td></tr><tr><td data-num="4"></td><td><pre>    &lt;p>p2&lt;/p></pre></td></tr><tr><td data-num="5"></td><td><pre>    &lt;p>p3&lt;/p></pre></td></tr><tr><td data-num="6"></td><td><pre>&lt;/div></pre></td></tr><tr><td data-num="7"></td><td><pre>&lt;div></pre></td></tr><tr><td data-num="8"></td><td><pre>    &lt;h1>h2&lt;/h1>  //变红</pre></td></tr><tr><td data-num="9"></td><td><pre>&lt;/div></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre> div :only-child</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre> <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><ul><li>:empty 没有子元素包括文本节点</li><li>:nth-last-child (n) 倒数第 n 个子元素</li><li>element:nth-last-of-type (n) 同类型的倒数第 n 个子元素</li><li>element:only-of-type 父元素里唯一同类型子元素</li></ul><figure class="highlight css"><figcaption data-lang="CSS"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token selector">&lt;!DOCTYPE html></pre></td></tr><tr><td data-num="2"></td><td><pre>&lt;html></pre></td></tr><tr><td data-num="3"></td><td><pre>&lt;head></pre></td></tr><tr><td data-num="4"></td><td><pre>&lt;style> </pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>div h1:only-of-type</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>&lt;/style></pre></td></tr><tr><td data-num="11"></td><td><pre>&lt;/head></pre></td></tr><tr><td data-num="12"></td><td><pre>&lt;body></pre></td></tr><tr><td data-num="13"></td><td><pre>&lt;div></pre></td></tr><tr><td data-num="14"></td><td><pre>    &lt;h1>h1&lt;/h1></pre></td></tr><tr><td data-num="15"></td><td><pre>    &lt;p>p1&lt;/p></pre></td></tr><tr><td data-num="16"></td><td><pre>    &lt;p>p2&lt;/p></pre></td></tr><tr><td data-num="17"></td><td><pre>    &lt;p>p3&lt;/p></pre></td></tr><tr><td data-num="18"></td><td><pre>    &lt;h1>h1&lt;/h1></pre></td></tr><tr><td data-num="19"></td><td><pre>&lt;/div></pre></td></tr><tr><td data-num="20"></td><td><pre>&lt;div></pre></td></tr><tr><td data-num="21"></td><td><pre>    &lt;h1>h2&lt;/h1>  //被选中</pre></td></tr><tr><td data-num="22"></td><td><pre>&lt;/div></pre></td></tr><tr><td data-num="23"></td><td><pre>&lt;/body></pre></td></tr><tr><td data-num="24"></td><td><pre>&lt;/html></pre></td></tr></table></figure><ul><li>a:active 链接正在被点击</li><li>a:hover 鼠标指针位于其上的链接</li><li>a:visited 被访问过的链接</li><li>:focus  用于选取获得焦点的元素</li><li>:enabled/:disabled 选择每个启用的 input 元素 / 选择每个禁用的 input 元素</li><li>:checked 选择每个被选择的 input 元素。自定义开关可以用这个实现</li><li>:not (selector) 选择分 selector 元素的每个元素（反向选择）</li></ul><h2 id="伪元素选择器"><a class="anchor" href="#伪元素选择器">#</a> 伪元素选择器</h2><ul><li>element:first-line</li></ul><figure class="highlight css"><figcaption data-lang="CSS"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token selector">&lt;!DOCTYPE html></pre></td></tr><tr><td data-num="2"></td><td><pre>&lt;html></pre></td></tr><tr><td data-num="3"></td><td><pre>&lt;head></pre></td></tr><tr><td data-num="4"></td><td><pre>&lt;style></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>p:first-line</span><span class="token punctuation">&#123;</span>  //第一行文字发生改变</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token property">background-color</span><span class="token punctuation">:</span>yellow<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>&lt;/style></pre></td></tr><tr><td data-num="11"></td><td><pre>&lt;/head></pre></td></tr><tr><td data-num="12"></td><td><pre>&lt;body></pre></td></tr><tr><td data-num="13"></td><td><pre>&lt;h1>WWF's Mission Statement&lt;/h1></pre></td></tr><tr><td data-num="14"></td><td><pre>&lt;p>To stop the degradation of the planet<span class="token string">'s natural environment and to build a future in which humans live in harmony with nature, by; conserving the world'</span>s biological diversity<span class="token punctuation">,</span> ensuring that the use of renewable natural resources is sustainable<span class="token punctuation">,</span> and promoting the reduction of pollution and wasteful consumption.&lt;/p></pre></td></tr><tr><td data-num="15"></td><td><pre>&lt;/body></pre></td></tr><tr><td data-num="16"></td><td><pre>&lt;/html></pre></td></tr></table></figure><ul><li>element:fitst-letter</li></ul><figure class="highlight css"><figcaption data-lang="CSS"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token selector">&lt;!DOCTYPE html></pre></td></tr><tr><td data-num="2"></td><td><pre>&lt;html></pre></td></tr><tr><td data-num="3"></td><td><pre>&lt;head></pre></td></tr><tr><td data-num="4"></td><td><pre>&lt;style></pre></td></tr><tr><td data-num="5"></td><td><pre>h1:first-letter</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token property">color</span><span class="token punctuation">:</span>yellow<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>&lt;/style></pre></td></tr><tr><td data-num="9"></td><td><pre>&lt;/head></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>&lt;body></pre></td></tr><tr><td data-num="12"></td><td><pre>&lt;h1>WWF's Mission Statement&lt;/h1>   //第一个字发生改变</pre></td></tr><tr><td data-num="13"></td><td><pre>&lt;/body></pre></td></tr><tr><td data-num="14"></td><td><pre>&lt;/html></pre></td></tr></table></figure><ul><li>element:before  在元素的内容前面插入内容</li></ul><figure class="highlight css"><figcaption data-lang="CSS"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token selector">h1:before</span> </pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token property">content</span><span class="token punctuation">:</span><span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>smiley.gif<span class="token punctuation">)</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><ul><li><p>element:after  在元素的内容后面插入内容</p></li><li><p>:selector  选择被用户选取的元素部分</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;代码笔记&lt;/p&gt;
    
    </summary>
    
    
      <category term="CSS" scheme="http://yoursite.com/categories/css/"/>
    
    
      <category term="CSS常用知识点" scheme="http://yoursite.com/tags/CSS%E5%B8%B8%E7%94%A8%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
    
  </entry>
  
  <entry>
    <title>JS笔记：原生轮播图move函数</title>
    <link href="http://yoursite.com/2020/08/07/2020-08-07.2/"/>
    <id>http://yoursite.com/2020/08/07/2020-08-07.2/</id>
    <published>2020-08-07T13:25:15.382Z</published>
    <updated>2020-11-12T15:53:49.172Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>代码笔记</p><a id="more"></a><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">/*</pre></td></tr><tr><td data-num="2"></td><td><pre>        参数：</pre></td></tr><tr><td data-num="3"></td><td><pre>            obj：要移动的对象</pre></td></tr><tr><td data-num="4"></td><td><pre>            attr: 样式，如：left right top 等等</pre></td></tr><tr><td data-num="5"></td><td><pre>            target：目标位置</pre></td></tr><tr><td data-num="6"></td><td><pre>            speed：每次移动的距离</pre></td></tr><tr><td data-num="7"></td><td><pre>            itemtime: 定时器调用的间隔时间</pre></td></tr><tr><td data-num="8"></td><td><pre>            callback: 回调函数，使其无线可能，在动画执行完毕后执行   (可传可不传)</pre></td></tr><tr><td data-num="9"></td><td><pre>            如：move (obj,left,target,speed,function ()&#123;</pre></td></tr><tr><td data-num="10"></td><td><pre>                move (obj,right,target,speed,function ()&#123;</pre></td></tr><tr><td data-num="11"></td><td><pre>                    move (obj,right,target,speed)</pre></td></tr><tr><td data-num="12"></td><td><pre>                &#125;)</pre></td></tr><tr><td data-num="13"></td><td><pre>            &#125;)</pre></td></tr><tr><td data-num="14"></td><td><pre>    */</span> </pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">function</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span>attr<span class="token punctuation">,</span>target<span class="token punctuation">,</span>speed<span class="token punctuation">,</span>itemtime<span class="token punctuation">,</span>callback</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token comment">// 注意点：如果定时器关闭前又被打开，定时器效果会叠加，所以每次打开要关闭之前的定时器</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token function">clearInterval</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>intervalId<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token comment">// 获取对象当前的位置</span></pre></td></tr><tr><td data-num="21"></td><td><pre>         <span class="token keyword">var</span> current <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">getStyle</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span>attr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>         <span class="token comment">// 根据当前对象的位置与目标位置来判断要向左还是向右移动</span></pre></td></tr><tr><td data-num="24"></td><td><pre>         <span class="token keyword">if</span><span class="token punctuation">(</span>current<span class="token operator">></span>target<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token comment">// 向左</span></pre></td></tr><tr><td data-num="25"></td><td><pre>             speed <span class="token operator">=</span> <span class="token operator">-</span>speed<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>         <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token comment">//  开启私人（防止多人时冲突）定时器，使对象移动</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        obj<span class="token punctuation">.</span>intervalId <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>            <span class="token comment">// 获取当前元素的有效位置</span></pre></td></tr><tr><td data-num="31"></td><td><pre>            <span class="token keyword">var</span> oldValue <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">getStyle</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span>attr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre>            <span class="token comment">// 在旧值的基础上加上每次移动的距离</span></pre></td></tr><tr><td data-num="34"></td><td><pre>            <span class="token keyword">var</span> newValue <span class="token operator">=</span> oldValue <span class="token operator">+</span> speed</pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre>            <span class="token comment">// 判断元素移动的方向和防止元素移动的距离超出目标距离</span></pre></td></tr><tr><td data-num="37"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>speed<span class="token operator">&lt;</span><span class="token number">0</span> <span class="token operator">&amp;&amp;</span> newValue<span class="token operator">&lt;</span>target<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>speed<span class="token operator">></span><span class="token number">0</span> <span class="token operator">&amp;&amp;</span> newValue<span class="token operator">></span>target<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>                newValue <span class="token operator">=</span> target<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre>            <span class="token comment">// 将新值赋给元素</span></pre></td></tr><tr><td data-num="42"></td><td><pre>            obj<span class="token punctuation">.</span>style<span class="token punctuation">[</span>attr<span class="token punctuation">]</span> <span class="token operator">=</span> newValue <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre></pre></td></tr><tr><td data-num="44"></td><td><pre>            <span class="token comment">// 到达目标关闭定时器</span></pre></td></tr><tr><td data-num="45"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>newValue <span class="token operator">===</span> target<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>                </pre></td></tr><tr><td data-num="47"></td><td><pre>                <span class="token function">clearInterval</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>intervalId<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre>                <span class="token comment">// 关键：动画执行完毕之后执行回调函数 (可无限套娃) ,&amp;&amp; 作用：参数给不给这个回调函数都没关系</span></pre></td></tr><tr><td data-num="50"></td><td><pre>                callback <span class="token operator">&amp;&amp;</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> itemtime<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="54"></td><td><pre></pre></td></tr><tr><td data-num="55"></td><td><pre>    </pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token comment">// 读取元素当前（浏览器中显示的）样式的方法（关键）</span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token comment">// 注意：getComputerStyle () 和 currentStyle 获取到的样式都是只读的，不能修改</span></pre></td></tr><tr><td data-num="58"></td><td><pre>    <span class="token comment">//      如果想修改，要通过 style 属性</span></pre></td></tr><tr><td data-num="59"></td><td><pre>    <span class="token comment">/*</pre></td></tr><tr><td data-num="60"></td><td><pre>        可以使用 getComputerStyle (参数 1，参数 2)，方法，这个方法是 window 的，可以直接使用</pre></td></tr><tr><td data-num="61"></td><td><pre>        参数 1：要获取样式的元素</pre></td></tr><tr><td data-num="62"></td><td><pre>        参数 2：可以传递一个伪元素，一般都传 null</pre></td></tr><tr><td data-num="63"></td><td><pre>        ** 该方法会返回一个对象，对象中封装了当前元素对应的样式</pre></td></tr><tr><td data-num="64"></td><td><pre>            可以通过对象。样式名来读取样式</pre></td></tr><tr><td data-num="65"></td><td><pre>            如果获取的样式没有设置，则会返回该样式在浏览器中显示的真实值，而不是返回一个 auto</pre></td></tr><tr><td data-num="66"></td><td><pre>            比如：没有设置 width 样式，则返回浏览器中真实的 width 宽度，而不是 auto</pre></td></tr><tr><td data-num="67"></td><td><pre>    */</span></pre></td></tr><tr><td data-num="68"></td><td><pre>    <span class="token keyword">function</span> <span class="token function">getStyle</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span>name</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// 注意：为兼容 IE8，此处 window 不能省，使 getComputerStyle 变成一个属性，而不是变量</span></pre></td></tr><tr><td data-num="69"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>getComputedStyle<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>            <span class="token comment">// 正常浏览器的方式，都具有 getComputerStyle () 方法，getComputerStyle () 是 window 的方法，可以直接使用</span></pre></td></tr><tr><td data-num="71"></td><td><pre>            <span class="token comment">// 注意此处不能 return getComputedStyle (obj,null).name, 这样的话 name 会写死，获取到样式名，而不是样式</span></pre></td></tr><tr><td data-num="72"></td><td><pre>            <span class="token keyword">return</span> <span class="token function">getComputedStyle</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="73"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>            <span class="token comment">// 兼容 IE8 的方式，IE8 没有 getComputerStyle () 方法，IE 浏览器有 currentStyle 属性可以使用</span></pre></td></tr><tr><td data-num="75"></td><td><pre>            <span class="token keyword">return</span> obj<span class="token punctuation">.</span>currentStyle<span class="token punctuation">[</span>name<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="76"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="77"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;代码笔记&lt;/p&gt;
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://yoursite.com/categories/javascript/"/>
    
    
      <category term="move工具函数" scheme="http://yoursite.com/tags/move%E5%B7%A5%E5%85%B7%E5%87%BD%E6%95%B0/"/>
    
  </entry>
  
  <entry>
    <title>JS笔记：原生轮播图</title>
    <link href="http://yoursite.com/2020/08/07/2020-08-07.1/"/>
    <id>http://yoursite.com/2020/08/07/2020-08-07.1/</id>
    <published>2020-08-07T13:22:38.387Z</published>
    <updated>2020-11-12T15:53:37.547Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>代码笔记</p><a id="more"></a><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token operator">&lt;</span>head<span class="token operator">></span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"viewport"</span> content<span class="token operator">=</span><span class="token string">"width=device-width, initial-scale=1.0"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token operator">&lt;</span>title<span class="token operator">></span>Document<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token operator">&lt;</span>style<span class="token operator">></span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token operator">*</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>            padding<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>            margin<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        #outdiv<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>            width<span class="token operator">:</span> <span class="token number">600</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>            height<span class="token operator">:</span> <span class="token number">400</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            padding<span class="token operator">:</span> <span class="token number">10</span>px <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            background<span class="token operator">-</span>color<span class="token operator">:</span> aquamarine<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            margin<span class="token operator">:</span> <span class="token number">50</span>px auto<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            position<span class="token operator">:</span> relative<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            overflow<span class="token operator">:</span> hidden<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token comment">/* 要明确左右移动的是整个 imglist，而不是 li */</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        #imglist<span class="token punctuation">&#123;</span>   </pre></td></tr><tr><td data-num="23"></td><td><pre>            list<span class="token operator">-</span>style<span class="token operator">:</span> none<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            <span class="token comment">/* 设置图片列表的总宽度 */</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            width<span class="token operator">:</span> <span class="token number">3000</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>            height<span class="token operator">:</span> <span class="token number">400</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>            <span class="token comment">/* 要移动 left 值，要先开动定位 */</span></pre></td></tr><tr><td data-num="28"></td><td><pre>            position<span class="token operator">:</span> absolute<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>            left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        #imglist li<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>            <span class="token comment">/* 给个浮动，让图片列表横过来 */</span></pre></td></tr><tr><td data-num="34"></td><td><pre>            float<span class="token operator">:</span> left<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        #pointlist<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>            <span class="token comment">/* 同样是决定定位，后面的覆盖前面的 */</span></pre></td></tr><tr><td data-num="38"></td><td><pre>            position<span class="token operator">:</span> absolute<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>            <span class="token comment">/* 根据图片的增减，此处需要动态设置小圆点的居中 ((图片的宽度 - pointlist 的宽度)/2) */</span></pre></td></tr><tr><td data-num="40"></td><td><pre>            <span class="token comment">/* left: 235.25px; */</span></pre></td></tr><tr><td data-num="41"></td><td><pre>            bottom<span class="token operator">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        #pointlist a<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>            width<span class="token operator">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>            height<span class="token operator">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>            margin<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">5</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>            float<span class="token operator">:</span> left<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>            background<span class="token operator">-</span>color<span class="token operator">:</span> red<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>            opacity<span class="token operator">:</span> <span class="token number">.7</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>        <span class="token comment">/* 设置鼠标移入小圆点的效果 */</span></pre></td></tr><tr><td data-num="52"></td><td><pre>        #pointlist a<span class="token operator">:</span>hover<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>            background<span class="token operator">-</span>color<span class="token operator">:</span> black<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">></span></pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"./animation.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></pre></td></tr><tr><td data-num="57"></td><td><pre></pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token operator">&lt;</span>body<span class="token operator">></span></pre></td></tr><tr><td data-num="60"></td><td><pre>    <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"outdiv"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="61"></td><td><pre>        <span class="token operator">&lt;</span>ul id<span class="token operator">=</span><span class="token string">"imglist"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="62"></td><td><pre>            <span class="token operator">&lt;</span>li<span class="token operator">></span><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"./img/1.jpg"</span> alt<span class="token operator">=</span><span class="token string">""</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span></pre></td></tr><tr><td data-num="63"></td><td><pre>            <span class="token operator">&lt;</span>li<span class="token operator">></span><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"./img/2.jpg"</span> alt<span class="token operator">=</span><span class="token string">""</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span></pre></td></tr><tr><td data-num="64"></td><td><pre>            <span class="token operator">&lt;</span>li<span class="token operator">></span><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"./img/3.jpg"</span> alt<span class="token operator">=</span><span class="token string">""</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span></pre></td></tr><tr><td data-num="65"></td><td><pre>            <span class="token operator">&lt;</span>li<span class="token operator">></span><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"./img/4.jpg"</span> alt<span class="token operator">=</span><span class="token string">""</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span></pre></td></tr><tr><td data-num="66"></td><td><pre>            <span class="token operator">&lt;</span>li<span class="token operator">></span><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"./img/5.jpg"</span> alt<span class="token operator">=</span><span class="token string">""</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span></pre></td></tr><tr><td data-num="67"></td><td><pre>            <span class="token operator">&lt;</span>li<span class="token operator">></span><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"./img/1.jpg"</span> alt<span class="token operator">=</span><span class="token string">""</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span></pre></td></tr><tr><td data-num="68"></td><td><pre></pre></td></tr><tr><td data-num="69"></td><td><pre>        <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span></pre></td></tr><tr><td data-num="70"></td><td><pre>        <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"pointlist"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="71"></td><td><pre>            <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"javascript:;"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span></pre></td></tr><tr><td data-num="72"></td><td><pre>            <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"javascript:;"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span></pre></td></tr><tr><td data-num="73"></td><td><pre>            <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"javascript:;"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span></pre></td></tr><tr><td data-num="74"></td><td><pre>            <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"javascript:;"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span></pre></td></tr><tr><td data-num="75"></td><td><pre>            <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"javascript:;"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span></pre></td></tr><tr><td data-num="76"></td><td><pre>        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="77"></td><td><pre>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="78"></td><td><pre><span class="token operator">&lt;</span>script<span class="token operator">></span></pre></td></tr><tr><td data-num="79"></td><td><pre>    window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="80"></td><td><pre>        <span class="token comment">/*</pre></td></tr><tr><td data-num="81"></td><td><pre>            思路：</pre></td></tr><tr><td data-num="82"></td><td><pre>                1. 第一部分：完成轮播图的部署，包括切换小圆点的部署               </pre></td></tr><tr><td data-num="83"></td><td><pre>                    注意点：</pre></td></tr><tr><td data-num="84"></td><td><pre>                        1）. 要可以动态的增加或减少图片的数目，使 imglist 可以自动调整宽度</pre></td></tr><tr><td data-num="85"></td><td><pre>                        2）. 对应的要可以动态的增加或小圆点的数目，使其自动居中</pre></td></tr><tr><td data-num="86"></td><td><pre></pre></td></tr><tr><td data-num="87"></td><td><pre>                2. 第二部分：手动切换轮播图，点击对应的小圆点，切换到对应的图片</pre></td></tr><tr><td data-num="88"></td><td><pre></pre></td></tr><tr><td data-num="89"></td><td><pre>                3. 第三部分：开启自动轮播定时器</pre></td></tr><tr><td data-num="90"></td><td><pre>        */</span></pre></td></tr><tr><td data-num="91"></td><td><pre></pre></td></tr><tr><td data-num="92"></td><td><pre>        <span class="token comment">/* 第一部分 */</span></pre></td></tr><tr><td data-num="93"></td><td><pre>        <span class="token comment">// 动态设置 imglist 的宽度</span></pre></td></tr><tr><td data-num="94"></td><td><pre>        <span class="token keyword">var</span> imglist <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'imglist'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="95"></td><td><pre>        <span class="token keyword">var</span> liunmber<span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="96"></td><td><pre>        <span class="token comment">// 注意：imglist.style. 只能读取和设置内联样式    </span></pre></td></tr><tr><td data-num="97"></td><td><pre>        imglist<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> liunmber<span class="token punctuation">.</span>length <span class="token operator">*</span> <span class="token number">600</span> <span class="token operator">+</span> <span class="token string">'px'</span></pre></td></tr><tr><td data-num="98"></td><td><pre></pre></td></tr><tr><td data-num="99"></td><td><pre>        <span class="token comment">// 动态设置小圆点 pointlist 居中</span></pre></td></tr><tr><td data-num="100"></td><td><pre>        <span class="token keyword">var</span> outdiv <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'outdiv'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="101"></td><td><pre>        <span class="token keyword">var</span> pointlist <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'pointlist'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="102"></td><td><pre>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>outdiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="103"></td><td><pre>        pointlist<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token punctuation">(</span>outdiv<span class="token punctuation">.</span>offsetWidth<span class="token operator">-</span>pointlist<span class="token punctuation">.</span>offsetWidth<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token string">'px'</span></pre></td></tr><tr><td data-num="104"></td><td><pre>        </pre></td></tr><tr><td data-num="105"></td><td><pre></pre></td></tr><tr><td data-num="106"></td><td><pre>        <span class="token comment">/* 第二部分 */</span></pre></td></tr><tr><td data-num="107"></td><td><pre>        <span class="token comment">// 设置默认选中的小圆点</span></pre></td></tr><tr><td data-num="108"></td><td><pre>        <span class="token keyword">var</span> index <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="109"></td><td><pre>        <span class="token keyword">var</span> Alla <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="110"></td><td><pre>        Alla<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">'black'</span></pre></td></tr><tr><td data-num="111"></td><td><pre></pre></td></tr><tr><td data-num="112"></td><td><pre>        <span class="token comment">// 设置一个定时器使它平滑的切换</span></pre></td></tr><tr><td data-num="113"></td><td><pre>        <span class="token keyword">var</span> AllTime <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span> <span class="token comment">// 每张照片移动的时间</span></pre></td></tr><tr><td data-num="114"></td><td><pre>        <span class="token keyword">var</span> itemtime <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span> <span class="token comment">// 每小段的间隔时间</span></pre></td></tr><tr><td data-num="115"></td><td><pre>        <span class="token keyword">var</span> itemwidth <span class="token operator">=</span> <span class="token number">600</span><span class="token operator">/</span><span class="token punctuation">(</span>AllTime<span class="token operator">/</span>itemtime<span class="token punctuation">)</span> <span class="token comment">// 每张图分成的小段距离</span></pre></td></tr><tr><td data-num="116"></td><td><pre></pre></td></tr><tr><td data-num="117"></td><td><pre>        <span class="token comment">// 遍历小圆点，绑定点击事件，并点击后切换图片</span></pre></td></tr><tr><td data-num="118"></td><td><pre>        <span class="token comment">// 注意：for 循环先遍历并每个 a 都绑定了事件</span></pre></td></tr><tr><td data-num="119"></td><td><pre>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>Alla<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="120"></td><td><pre>            Alla<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>num <span class="token operator">=</span> i</pre></td></tr><tr><td data-num="121"></td><td><pre>            Alla<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="122"></td><td><pre></pre></td></tr><tr><td data-num="123"></td><td><pre>                <span class="token comment">// 当进行手动操作时关闭自动定时器</span></pre></td></tr><tr><td data-num="124"></td><td><pre>                <span class="token function">clearInterval</span><span class="token punctuation">(</span>setintervalid<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="125"></td><td><pre></pre></td></tr><tr><td data-num="126"></td><td><pre>                <span class="token comment">// 注意此处用 this 不是用 Alla [i].num</span></pre></td></tr><tr><td data-num="127"></td><td><pre>                <span class="token comment">// alert(this.num)</span></pre></td></tr><tr><td data-num="128"></td><td><pre>                index <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>num</pre></td></tr><tr><td data-num="129"></td><td><pre>                Alla<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor<span class="token operator">=</span> <span class="token string">'black'</span></pre></td></tr><tr><td data-num="130"></td><td><pre></pre></td></tr><tr><td data-num="131"></td><td><pre>                <span class="token comment">// 调用小圆点颜色切换函数 (此处有产生闭包)</span></pre></td></tr><tr><td data-num="132"></td><td><pre>                <span class="token function">pointqh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="133"></td><td><pre></pre></td></tr><tr><td data-num="134"></td><td><pre>                <span class="token comment">// 切换图片</span></pre></td></tr><tr><td data-num="135"></td><td><pre>               <span class="token comment">/* 第一张图片：0 *600</pre></td></tr><tr><td data-num="136"></td><td><pre>                第二张图片：-1 * 600</pre></td></tr><tr><td data-num="137"></td><td><pre>                第三张图片：-2 * 600</pre></td></tr><tr><td data-num="138"></td><td><pre>                。。。*/</span></pre></td></tr><tr><td data-num="139"></td><td><pre>                <span class="token comment">// 点击切换图片</span></pre></td></tr><tr><td data-num="140"></td><td><pre>                <span class="token function">move</span><span class="token punctuation">(</span>imglist<span class="token punctuation">,</span><span class="token string">'left'</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">600</span><span class="token operator">*</span>index<span class="token punctuation">,</span>itemwidth<span class="token punctuation">,</span>itemtime<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="141"></td><td><pre>                    <span class="token comment">// 手动切换完成后又开启自动定时器</span></pre></td></tr><tr><td data-num="142"></td><td><pre>                    <span class="token function">autoqh</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="143"></td><td><pre>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="144"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="145"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="146"></td><td><pre></pre></td></tr><tr><td data-num="147"></td><td><pre>        <span class="token comment">// 点击后小圆点的颜色改变</span></pre></td></tr><tr><td data-num="148"></td><td><pre>        <span class="token keyword">function</span> <span class="token function">pointqh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="149"></td><td><pre>            <span class="token comment">// 当切换到第六张图片时，将小圆点切换到第一个</span></pre></td></tr><tr><td data-num="150"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>index <span class="token operator">>=</span> liunmber<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="151"></td><td><pre>                index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="152"></td><td><pre>                <span class="token comment">// 将图片切换回第一张</span></pre></td></tr><tr><td data-num="153"></td><td><pre>                imglist<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="154"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="155"></td><td><pre>            <span class="token comment">// 先遍历将小圆点的颜色都变成红色</span></pre></td></tr><tr><td data-num="156"></td><td><pre>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>Alla<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="157"></td><td><pre>            <span class="token comment">/* 此处需注意：由于内联样式优先级较高，所以点击之后 backgroundColor = 'red'，</pre></td></tr><tr><td data-num="158"></td><td><pre>                会时 hover 失效，所以这里 red 不能要，但默认样式有设成红色，所以 ok*/</span></pre></td></tr><tr><td data-num="159"></td><td><pre>            </pre></td></tr><tr><td data-num="160"></td><td><pre>                Alla<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">''</span></pre></td></tr><tr><td data-num="161"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="162"></td><td><pre></pre></td></tr><tr><td data-num="163"></td><td><pre>            <span class="token comment">// 使用了外部函数变量 index，产生闭包</span></pre></td></tr><tr><td data-num="164"></td><td><pre>            Alla<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">'black'</span></pre></td></tr><tr><td data-num="165"></td><td><pre></pre></td></tr><tr><td data-num="166"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="167"></td><td><pre></pre></td></tr><tr><td data-num="168"></td><td><pre></pre></td></tr><tr><td data-num="169"></td><td><pre>        <span class="token comment">/* 第三部分 */</span></pre></td></tr><tr><td data-num="170"></td><td><pre>        <span class="token comment">// 启动自动切换功能</span></pre></td></tr><tr><td data-num="171"></td><td><pre>        <span class="token function">autoqh</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="172"></td><td><pre></pre></td></tr><tr><td data-num="173"></td><td><pre>        <span class="token comment">// 定义成全局定时器，方便其他函数进行关闭开启的操作</span></pre></td></tr><tr><td data-num="174"></td><td><pre>        <span class="token keyword">var</span> setintervalid<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="175"></td><td><pre></pre></td></tr><tr><td data-num="176"></td><td><pre>        <span class="token keyword">function</span> <span class="token function">autoqh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="177"></td><td><pre>            <span class="token comment">// 开启定时器</span></pre></td></tr><tr><td data-num="178"></td><td><pre>            setintervalid <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="179"></td><td><pre>                </pre></td></tr><tr><td data-num="180"></td><td><pre>                <span class="token comment">//index 自增</span></pre></td></tr><tr><td data-num="181"></td><td><pre>                index<span class="token operator">++</span></pre></td></tr><tr><td data-num="182"></td><td><pre>                <span class="token comment">// 调用 move 函数</span></pre></td></tr><tr><td data-num="183"></td><td><pre>                <span class="token function">move</span><span class="token punctuation">(</span>imglist<span class="token punctuation">,</span><span class="token string">'left'</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">600</span><span class="token operator">*</span>index<span class="token punctuation">,</span>itemwidth<span class="token punctuation">,</span>itemtime<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="184"></td><td><pre>                    <span class="token comment">// 图片移动的同时切换小圆点</span></pre></td></tr><tr><td data-num="185"></td><td><pre>                    <span class="token function">pointqh</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="186"></td><td><pre>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="187"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span>    </pre></td></tr><tr><td data-num="188"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="189"></td><td><pre></pre></td></tr><tr><td data-num="190"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="191"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></pre></td></tr><tr><td data-num="192"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span></pre></td></tr><tr><td data-num="193"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;代码笔记&lt;/p&gt;
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://yoursite.com/categories/javascript/"/>
    
    
      <category term="原生轮播图" scheme="http://yoursite.com/tags/%E5%8E%9F%E7%94%9F%E8%BD%AE%E6%92%AD%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>jQuery笔记：练习:点击回到顶部</title>
    <link href="http://yoursite.com/2020/08/05/2020-08-05.9/"/>
    <id>http://yoursite.com/2020/08/05/2020-08-05.9/</id>
    <published>2020-08-05T13:04:47.923Z</published>
    <updated>2020-11-12T15:52:17.846Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>代码笔记</p><a id="more"></a><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">&lt;</span>html<span class="token operator">></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token operator">&lt;</span>head<span class="token operator">></span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token operator">&lt;</span>title<span class="token operator">></span><span class="token number">03</span>_回到顶部<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token operator">&lt;</span>style<span class="token operator">></span></pre></td></tr><tr><td data-num="8"></td><td><pre>    #to_top <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>      width<span class="token operator">:</span> <span class="token number">30</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>      height<span class="token operator">:</span> <span class="token number">40</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      font<span class="token operator">:</span> <span class="token number">14</span>px<span class="token operator">/</span><span class="token number">20</span>px arial<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      background<span class="token operator">:</span> #<span class="token number">06</span>c<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>      position<span class="token operator">:</span> fixed<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>      cursor<span class="token operator">:</span> pointer<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>      color<span class="token operator">:</span> #fff<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      left<span class="token operator">:</span> <span class="token number">1050</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      top<span class="token operator">:</span> <span class="token number">500</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">></span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token operator">&lt;</span>body style<span class="token operator">=</span><span class="token string">"height: 2000px;"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"to_top"</span><span class="token operator">></span>返回顶部<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span> src<span class="token operator">=</span><span class="token string">"jquery-1.10.1.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="28"></td><td><pre>  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#to_top'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token comment">// 瞬间回到顶部</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token comment">// $('html,body').scrollTop(0)</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token comment">// 平滑回到顶部</span></pre></td></tr><tr><td data-num="33"></td><td><pre>      <span class="token comment">// 测出总距离</span></pre></td></tr><tr><td data-num="34"></td><td><pre>      <span class="token keyword">var</span> $page <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'html,body'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>      <span class="token keyword">var</span> distance <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">scrollTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">scrollTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>      </pre></td></tr><tr><td data-num="37"></td><td><pre>      <span class="token comment">// 设置回到顶部所需的总时间</span></pre></td></tr><tr><td data-num="38"></td><td><pre>      <span class="token keyword">var</span> time <span class="token operator">=</span> <span class="token number">500</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre>      <span class="token comment">// 间隔时间</span></pre></td></tr><tr><td data-num="41"></td><td><pre>      <span class="token keyword">var</span> intervalTime <span class="token operator">=</span> <span class="token number">10</span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre>      <span class="token comment">// 每小段的距离</span></pre></td></tr><tr><td data-num="44"></td><td><pre>      <span class="token keyword">var</span> itemDistance <span class="token operator">=</span> distance<span class="token operator">/</span><span class="token punctuation">(</span>time<span class="token operator">/</span>intervalTime<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre></pre></td></tr><tr><td data-num="46"></td><td><pre>      <span class="token comment">// 使用循环定时器不断滚动</span></pre></td></tr><tr><td data-num="47"></td><td><pre>      <span class="token keyword">var</span> intervalId <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>        distance <span class="token operator">-=</span> itemDistance</pre></td></tr><tr><td data-num="49"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>distance<span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>          distance <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment">// 修正</span></pre></td></tr><tr><td data-num="51"></td><td><pre>          <span class="token function">clearInterval</span><span class="token punctuation">(</span>intervalId<span class="token punctuation">)</span>  <span class="token comment">// 关闭定时器 </span></pre></td></tr><tr><td data-num="52"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>        $page<span class="token punctuation">.</span><span class="token function">scrollTop</span><span class="token punctuation">(</span>distance<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="54"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>intervalTime<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="55"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span></pre></td></tr><tr><td data-num="58"></td><td><pre></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;代码笔记&lt;/p&gt;
    
    </summary>
    
    
      <category term="jQuery" scheme="http://yoursite.com/categories/jQuery/"/>
    
    
      <category term="jQuery笔记" scheme="http://yoursite.com/tags/jQuery%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>jQuery笔记：练习:多Tab点击切换</title>
    <link href="http://yoursite.com/2020/08/05/2020-08-05.8/"/>
    <id>http://yoursite.com/2020/08/05/2020-08-05.8/</id>
    <published>2020-08-05T13:03:31.965Z</published>
    <updated>2020-11-12T15:52:51.925Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>代码笔记</p><a id="more"></a><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token operator">&lt;</span>head<span class="token operator">></span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token operator">&lt;</span>title<span class="token operator">></span><span class="token number">02</span>_多Tab点击切换<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token operator">&lt;</span>style<span class="token operator">></span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token operator">*</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>      margin<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>      padding<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>    #tab li <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      float<span class="token operator">:</span> left<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>      list<span class="token operator">-</span>style<span class="token operator">:</span> none<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>      width<span class="token operator">:</span> <span class="token number">80</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>      height<span class="token operator">:</span> <span class="token number">40</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      line<span class="token operator">-</span>height<span class="token operator">:</span> <span class="token number">40</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      cursor<span class="token operator">:</span> pointer<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>      text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>    #container <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>      position<span class="token operator">:</span> relative<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre>    #content1<span class="token punctuation">,</span> #content2<span class="token punctuation">,</span> #content3 <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>      width<span class="token operator">:</span> <span class="token number">300</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>      height<span class="token operator">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>      padding<span class="token operator">:</span> <span class="token number">30</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>      position<span class="token operator">:</span> absolute<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>      top<span class="token operator">:</span> <span class="token number">40</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>      left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre>    #tab1<span class="token punctuation">,</span> #content1 <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>      background<span class="token operator">-</span>color<span class="token operator">:</span> #ffcc00<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre>    #tab2<span class="token punctuation">,</span> #content2 <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>      background<span class="token operator">-</span>color<span class="token operator">:</span> #ff00cc<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre>    #tab3<span class="token punctuation">,</span> #content3 <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>      background<span class="token operator">-</span>color<span class="token operator">:</span> #<span class="token number">00</span>ccff<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>  <span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">></span></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token operator">&lt;</span>body<span class="token operator">></span></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token operator">&lt;</span>h2<span class="token operator">></span>多Tab点击切换<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">></span></pre></td></tr><tr><td data-num="50"></td><td><pre></pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token operator">&lt;</span>ul id<span class="token operator">=</span><span class="token string">"tab"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="52"></td><td><pre>  <span class="token operator">&lt;</span>li id<span class="token operator">=</span><span class="token string">"tab1"</span> value<span class="token operator">=</span><span class="token string">"1"</span><span class="token operator">></span><span class="token number">10</span>元套餐<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span></pre></td></tr><tr><td data-num="53"></td><td><pre>  <span class="token operator">&lt;</span>li id<span class="token operator">=</span><span class="token string">"tab2"</span> value<span class="token operator">=</span><span class="token string">"2"</span><span class="token operator">></span><span class="token number">30</span>元套餐<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span></pre></td></tr><tr><td data-num="54"></td><td><pre>  <span class="token operator">&lt;</span>li id<span class="token operator">=</span><span class="token string">"tab3"</span> value<span class="token operator">=</span><span class="token string">"3"</span><span class="token operator">></span><span class="token number">50</span>元包月<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span></pre></td></tr><tr><td data-num="56"></td><td><pre></pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"container"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="58"></td><td><pre>  <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"content1"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="59"></td><td><pre>    <span class="token number">10</span>元套餐详情：<span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">></span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span>每月套餐内拨打<span class="token number">100</span>分钟，超出部分<span class="token number">2</span>毛<span class="token operator">/</span>分钟</pre></td></tr><tr><td data-num="60"></td><td><pre>  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="61"></td><td><pre>  <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"content2"</span> style<span class="token operator">=</span><span class="token string">"display: none"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="62"></td><td><pre>    <span class="token number">30</span>元套餐详情：<span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">></span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span>每月套餐内拨打<span class="token number">300</span>分钟，超出部分<span class="token number">1.5</span>毛<span class="token operator">/</span>分钟</pre></td></tr><tr><td data-num="63"></td><td><pre>  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="64"></td><td><pre>  <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"content3"</span> style<span class="token operator">=</span><span class="token string">"display: none"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="65"></td><td><pre>    <span class="token number">50</span>元包月详情：<span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">></span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span>每月无限量随心打</pre></td></tr><tr><td data-num="66"></td><td><pre>  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="67"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="68"></td><td><pre></pre></td></tr><tr><td data-num="69"></td><td><pre></pre></td></tr><tr><td data-num="70"></td><td><pre><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span> src<span class="token operator">=</span><span class="token string">"jquery-1.10.1.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="72"></td><td><pre></pre></td></tr><tr><td data-num="73"></td><td><pre></pre></td></tr><tr><td data-num="74"></td><td><pre></pre></td></tr><tr><td data-num="75"></td><td><pre>  <span class="token keyword">var</span> $contents <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#container>div'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="76"></td><td><pre>  <span class="token comment">// 方式 1：</span></pre></td></tr><tr><td data-num="77"></td><td><pre>  <span class="token comment">//// 给 3 个 li 加监听</span></pre></td></tr><tr><td data-num="78"></td><td><pre>  <span class="token comment">// $('#tab>li').click (function ()&#123; // 隐式遍历</span></pre></td></tr><tr><td data-num="79"></td><td><pre>  <span class="token comment">//   // 隐藏所有内容 div</span></pre></td></tr><tr><td data-num="80"></td><td><pre>  <span class="token comment">//   $contents.css('display','none')</span></pre></td></tr><tr><td data-num="81"></td><td><pre>  <span class="token comment">//   // 显示对应的内容 div</span></pre></td></tr><tr><td data-num="82"></td><td><pre>  <span class="token comment">//   // 得到当前点击的 li 在兄弟中下标</span></pre></td></tr><tr><td data-num="83"></td><td><pre>  <span class="token comment">//   var index = $(this).index()</span></pre></td></tr><tr><td data-num="84"></td><td><pre>  <span class="token comment">//   // 找到对应内容 div，并显示方式 1：</span></pre></td></tr><tr><td data-num="85"></td><td><pre>  <span class="token comment">//   $contents[index].style.display = 'block'</span></pre></td></tr><tr><td data-num="86"></td><td><pre>  <span class="token comment">//   // 找到对应内容 div，并显示方式 2:</span></pre></td></tr><tr><td data-num="87"></td><td><pre>  <span class="token comment">//   // $($contents[index]).css('display','block')</span></pre></td></tr><tr><td data-num="88"></td><td><pre></pre></td></tr><tr><td data-num="89"></td><td><pre></pre></td></tr><tr><td data-num="90"></td><td><pre>  <span class="token comment">// &#125;)</span></pre></td></tr><tr><td data-num="91"></td><td><pre></pre></td></tr><tr><td data-num="92"></td><td><pre><span class="token comment">// 更好的方式 2：</span></pre></td></tr><tr><td data-num="93"></td><td><pre>  <span class="token keyword">var</span> currIndex  <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">// 当前显示内容 div 的下标</span></pre></td></tr><tr><td data-num="94"></td><td><pre>  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#tab>li'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token comment">// 隐式遍历</span></pre></td></tr><tr><td data-num="95"></td><td><pre>    <span class="token comment">// 点击时，隐藏当前已经显示的内容 div</span></pre></td></tr><tr><td data-num="96"></td><td><pre>    $contents<span class="token punctuation">[</span>currIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span></pre></td></tr><tr><td data-num="97"></td><td><pre>    <span class="token comment">// 显示被点击的 div 内容</span></pre></td></tr><tr><td data-num="98"></td><td><pre>      <span class="token comment">// 得到被点击的 div 下包</span></pre></td></tr><tr><td data-num="99"></td><td><pre>    <span class="token keyword">var</span> index <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="100"></td><td><pre>    <span class="token comment">// 找到被点击 div 并显示</span></pre></td></tr><tr><td data-num="101"></td><td><pre>    $contents<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'block'</span></pre></td></tr><tr><td data-num="102"></td><td><pre></pre></td></tr><tr><td data-num="103"></td><td><pre>    <span class="token comment">// 更新当前的下标</span></pre></td></tr><tr><td data-num="104"></td><td><pre>    currIndex <span class="token operator">=</span> index</pre></td></tr><tr><td data-num="105"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="106"></td><td><pre></pre></td></tr><tr><td data-num="107"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></pre></td></tr><tr><td data-num="108"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span></pre></td></tr><tr><td data-num="109"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;代码笔记&lt;/p&gt;
    
    </summary>
    
    
      <category term="jQuery" scheme="http://yoursite.com/categories/jQuery/"/>
    
    
      <category term="jQuery笔记" scheme="http://yoursite.com/tags/jQuery%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>jQuery笔记：练习:添加删除记录</title>
    <link href="http://yoursite.com/2020/08/05/2020-08-05.7/"/>
    <id>http://yoursite.com/2020/08/05/2020-08-05.7/</id>
    <published>2020-08-05T13:00:20.823Z</published>
    <updated>2020-11-12T16:06:02.468Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>代码笔记</p><a id="more"></a><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> <span class="token constant">HTML</span> <span class="token constant">PUBLIC</span> <span class="token string">"-//W3C//DTD HTML 4.01//EN"</span> <span class="token string">"http://www.w3.org/TR/html4/strict.dtd"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">&lt;</span>html<span class="token operator">></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token operator">&lt;</span>head<span class="token operator">></span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token operator">&lt;</span>meta http<span class="token operator">-</span>equiv<span class="token operator">=</span><span class="token string">"Content-Type"</span> content<span class="token operator">=</span><span class="token string">"text/html; charset=UTF-8"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token operator">&lt;</span>title<span class="token operator">></span>添加删除记录练习<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> type<span class="token operator">=</span><span class="token string">"text/css"</span> href<span class="token operator">=</span><span class="token string">"css.css"</span><span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token operator">&lt;</span>body<span class="token operator">></span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token operator">&lt;</span>table id<span class="token operator">=</span><span class="token string">"employeeTable"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token operator">&lt;</span>tr<span class="token operator">></span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token operator">&lt;</span>th<span class="token operator">></span>Name<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">></span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token operator">&lt;</span>th<span class="token operator">></span>Email<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">></span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token operator">&lt;</span>th<span class="token operator">></span>Salary<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">></span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token operator">&lt;</span>th<span class="token operator">></span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">></span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">></span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token operator">&lt;</span>tr<span class="token operator">></span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token operator">&lt;</span>td<span class="token operator">></span>Tom<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token operator">&lt;</span>td<span class="token operator">></span>tom@tom<span class="token punctuation">.</span>com<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token operator">&lt;</span>td<span class="token operator">></span><span class="token number">5000</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token operator">&lt;</span>td<span class="token operator">></span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"deleteEmp?id=001"</span><span class="token operator">></span>Delete<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span></pre></td></tr><tr><td data-num="23"></td><td><pre>  <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">></span></pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token operator">&lt;</span>tr<span class="token operator">></span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token operator">&lt;</span>td<span class="token operator">></span>Jerry<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token operator">&lt;</span>td<span class="token operator">></span>jerry@sohu<span class="token punctuation">.</span>com<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token operator">&lt;</span>td<span class="token operator">></span><span class="token number">8000</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token operator">&lt;</span>td<span class="token operator">></span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"deleteEmp?id=002"</span><span class="token operator">></span>Delete<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span></pre></td></tr><tr><td data-num="29"></td><td><pre>  <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">></span></pre></td></tr><tr><td data-num="30"></td><td><pre>  <span class="token operator">&lt;</span>tr<span class="token operator">></span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token operator">&lt;</span>td<span class="token operator">></span>Bob<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token operator">&lt;</span>td<span class="token operator">></span>bob@tom<span class="token punctuation">.</span>com<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token operator">&lt;</span>td<span class="token operator">></span><span class="token number">10000</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token operator">&lt;</span>td<span class="token operator">></span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"deleteEmp?id=003"</span><span class="token operator">></span>Delete<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span></pre></td></tr><tr><td data-num="35"></td><td><pre>  <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">></span></pre></td></tr><tr><td data-num="36"></td><td><pre></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>table<span class="token operator">></span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"formDiv"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre>  <span class="token operator">&lt;</span>h4<span class="token operator">></span>添加新员工<span class="token operator">&lt;</span><span class="token operator">/</span>h4<span class="token operator">></span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre>  <span class="token operator">&lt;</span>table<span class="token operator">></span></pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token operator">&lt;</span>tr<span class="token operator">></span></pre></td></tr><tr><td data-num="45"></td><td><pre>      <span class="token operator">&lt;</span>td <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"word"</span><span class="token operator">></span>name<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span></pre></td></tr><tr><td data-num="46"></td><td><pre>      <span class="token operator">&lt;</span>td <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"inp"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="47"></td><td><pre>        <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"empName"</span> id<span class="token operator">=</span><span class="token string">"empName"</span><span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="48"></td><td><pre>      <span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">></span></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token operator">&lt;</span>tr<span class="token operator">></span></pre></td></tr><tr><td data-num="51"></td><td><pre>      <span class="token operator">&lt;</span>td <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"word"</span><span class="token operator">></span>email<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span></pre></td></tr><tr><td data-num="52"></td><td><pre>      <span class="token operator">&lt;</span>td <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"inp"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="53"></td><td><pre>        <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"email"</span> id<span class="token operator">=</span><span class="token string">"email"</span><span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="54"></td><td><pre>      <span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">></span></pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token operator">&lt;</span>tr<span class="token operator">></span></pre></td></tr><tr><td data-num="57"></td><td><pre>      <span class="token operator">&lt;</span>td <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"word"</span><span class="token operator">></span>salary<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span></pre></td></tr><tr><td data-num="58"></td><td><pre>      <span class="token operator">&lt;</span>td <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"inp"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="59"></td><td><pre>        <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"salary"</span> id<span class="token operator">=</span><span class="token string">"salary"</span><span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="60"></td><td><pre>      <span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span></pre></td></tr><tr><td data-num="61"></td><td><pre>    <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">></span></pre></td></tr><tr><td data-num="62"></td><td><pre>    <span class="token operator">&lt;</span>tr<span class="token operator">></span></pre></td></tr><tr><td data-num="63"></td><td><pre>      <span class="token operator">&lt;</span>td colspan<span class="token operator">=</span><span class="token string">"2"</span> align<span class="token operator">=</span><span class="token string">"center"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="64"></td><td><pre>        <span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">"addEmpButton"</span> value<span class="token operator">=</span><span class="token string">"abc"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="65"></td><td><pre>          Submit</pre></td></tr><tr><td data-num="66"></td><td><pre>        <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span></pre></td></tr><tr><td data-num="67"></td><td><pre>      <span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span></pre></td></tr><tr><td data-num="68"></td><td><pre>    <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">></span></pre></td></tr><tr><td data-num="69"></td><td><pre>  <span class="token operator">&lt;</span><span class="token operator">/</span>table<span class="token operator">></span></pre></td></tr><tr><td data-num="70"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="71"></td><td><pre></pre></td></tr><tr><td data-num="72"></td><td><pre><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span> src<span class="token operator">=</span><span class="token string">"jquery-1.10.1.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></pre></td></tr><tr><td data-num="73"></td><td><pre><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="74"></td><td><pre>  <span class="token comment">/*</pre></td></tr><tr><td data-num="75"></td><td><pre>  1. 添加</pre></td></tr><tr><td data-num="76"></td><td><pre>  2. 删除</pre></td></tr><tr><td data-num="77"></td><td><pre>   */</span></pre></td></tr><tr><td data-num="78"></td><td><pre>  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#addEmpButton'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>    <span class="token comment">//1. 收集输入的数据</span></pre></td></tr><tr><td data-num="80"></td><td><pre>    <span class="token keyword">var</span> $empName <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#empName'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="81"></td><td><pre>    <span class="token keyword">var</span> $email <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#email'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="82"></td><td><pre>    <span class="token keyword">var</span> $salary <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#salary'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="83"></td><td><pre>    <span class="token keyword">var</span> empName <span class="token operator">=</span> $empName<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="84"></td><td><pre>    <span class="token keyword">var</span> email <span class="token operator">=</span> $email<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="85"></td><td><pre>    <span class="token keyword">var</span> salary <span class="token operator">=</span> $salary<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="86"></td><td><pre></pre></td></tr><tr><td data-num="87"></td><td><pre>    <span class="token comment">//2. 生成对应的 & lt;tr > 标签结构，并插入 #employeeTable 的 tbody 中</span></pre></td></tr><tr><td data-num="88"></td><td><pre>    <span class="token comment">/*</pre></td></tr><tr><td data-num="89"></td><td><pre>     &lt;tr></pre></td></tr><tr><td data-num="90"></td><td><pre>       &lt;td>Bob&lt;/td></pre></td></tr><tr><td data-num="91"></td><td><pre>       &lt;td>bob@tom.com&lt;/td></pre></td></tr><tr><td data-num="92"></td><td><pre>       &lt;td>10000&lt;/td></pre></td></tr><tr><td data-num="93"></td><td><pre>       &lt;td>&lt;a href="deleteEmp?id=003">Delete&lt;/a>&lt;/td></pre></td></tr><tr><td data-num="94"></td><td><pre>     &lt;/tr></pre></td></tr><tr><td data-num="95"></td><td><pre>     */</span></pre></td></tr><tr><td data-num="96"></td><td><pre>    <span class="token keyword">var</span> $xxx <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'&lt;tr>&lt;/tr>'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="97"></td><td><pre>      <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'&lt;td>'</span><span class="token operator">+</span>empName<span class="token operator">+</span><span class="token string">'&lt;/td>'</span><span class="token punctuation">)</span> <span class="token comment">// 拼串</span></pre></td></tr><tr><td data-num="98"></td><td><pre>      <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'&lt;td>'</span><span class="token operator">+</span>email<span class="token operator">+</span><span class="token string">'&lt;/td>'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="99"></td><td><pre>      <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'&lt;td>'</span><span class="token operator">+</span>salary<span class="token operator">+</span><span class="token string">'&lt;/td>'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="100"></td><td><pre>      <span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'&lt;td>&lt;a href="deleteEmp?id="'</span><span class="token operator">+</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'>Delete&lt;/a>&lt;/td>'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="101"></td><td><pre>      <span class="token punctuation">.</span><span class="token function">appendTo</span><span class="token punctuation">(</span><span class="token string">'#employeeTable>tbody'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="102"></td><td><pre>      <span class="token comment">// .find('a')</span></pre></td></tr><tr><td data-num="103"></td><td><pre>      <span class="token comment">// .click(clickDelete)</span></pre></td></tr><tr><td data-num="104"></td><td><pre></pre></td></tr><tr><td data-num="105"></td><td><pre>    <span class="token comment">//3. 清除输入</span></pre></td></tr><tr><td data-num="106"></td><td><pre>    $empName<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="107"></td><td><pre>    $email<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="108"></td><td><pre>    $salary<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="109"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="110"></td><td><pre></pre></td></tr><tr><td data-num="111"></td><td><pre>  <span class="token comment">// 给所有删除链接绑定点击监听</span></pre></td></tr><tr><td data-num="112"></td><td><pre>  <span class="token comment">// $('#employeeTable a').click(clickDelete)</span></pre></td></tr><tr><td data-num="113"></td><td><pre></pre></td></tr><tr><td data-num="114"></td><td><pre>  <span class="token comment">// 通过 table 实现对所有 a 的 click 事件委托</span></pre></td></tr><tr><td data-num="115"></td><td><pre>  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#employeeTable'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">delegate</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'click'</span><span class="token punctuation">,</span> clickDelete<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="116"></td><td><pre></pre></td></tr><tr><td data-num="117"></td><td><pre>  <span class="token comment">/*</pre></td></tr><tr><td data-num="118"></td><td><pre>  点击删除的回调函数</pre></td></tr><tr><td data-num="119"></td><td><pre>   */</span></pre></td></tr><tr><td data-num="120"></td><td><pre>  <span class="token keyword">function</span> <span class="token function">clickDelete</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="121"></td><td><pre>    <span class="token keyword">var</span> $tr <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="122"></td><td><pre>    <span class="token keyword">var</span> name <span class="token operator">=</span> $tr<span class="token punctuation">.</span><span class="token function">children</span><span class="token punctuation">(</span><span class="token string">':first'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="123"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">'确定删除'</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">'吗?'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="124"></td><td><pre>      $tr<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="125"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="126"></td><td><pre></pre></td></tr><tr><td data-num="127"></td><td><pre>    <span class="token keyword">return</span> <span class="token boolean">false</span></pre></td></tr><tr><td data-num="128"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="129"></td><td><pre>  </pre></td></tr><tr><td data-num="130"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></pre></td></tr><tr><td data-num="131"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span></pre></td></tr><tr><td data-num="132"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;代码笔记&lt;/p&gt;
    
    </summary>
    
    
      <category term="jQuery" scheme="http://yoursite.com/categories/jQuery/"/>
    
    
      <category term="jQuery笔记" scheme="http://yoursite.com/tags/jQuery%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>jQuery笔记：练习：爱好选择器</title>
    <link href="http://yoursite.com/2020/08/05/2020-08-05.6/"/>
    <id>http://yoursite.com/2020/08/05/2020-08-05.6/</id>
    <published>2020-08-05T12:58:50.190Z</published>
    <updated>2020-11-12T16:00:03.336Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>代码笔记</p><a id="more"></a><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html <span class="token constant">PUBLIC</span> <span class="token string">"-//W3C//DTD HTML 4.01 Transitional//EN"</span> <span class="token string">"http://www.w3.org/TR/html4/loose.dtd"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">&lt;</span>html<span class="token operator">></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token operator">&lt;</span>head<span class="token operator">></span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token operator">&lt;</span>meta http<span class="token operator">-</span>equiv<span class="token operator">=</span><span class="token string">"Content-Type"</span> content<span class="token operator">=</span><span class="token string">"text/html; charset=UTF-8"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token operator">&lt;</span>title<span class="token operator">></span>全选练习<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token operator">&lt;</span>body<span class="token operator">></span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token operator">&lt;</span>form<span class="token operator">></span></pre></td></tr><tr><td data-num="10"></td><td><pre>  你爱好的运动是？<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"checkbox"</span> id<span class="token operator">=</span><span class="token string">"checkedAllBox"</span><span class="token operator">/</span><span class="token operator">></span>全选<span class="token operator">/</span>全不选</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"checkbox"</span> name<span class="token operator">=</span><span class="token string">"items"</span> value<span class="token operator">=</span><span class="token string">"足球"</span><span class="token operator">/</span><span class="token operator">></span>足球</pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"checkbox"</span> name<span class="token operator">=</span><span class="token string">"items"</span> value<span class="token operator">=</span><span class="token string">"篮球"</span><span class="token operator">/</span><span class="token operator">></span>篮球</pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"checkbox"</span> name<span class="token operator">=</span><span class="token string">"items"</span> value<span class="token operator">=</span><span class="token string">"羽毛球"</span><span class="token operator">/</span><span class="token operator">></span>羽毛球</pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"checkbox"</span> name<span class="token operator">=</span><span class="token string">"items"</span> value<span class="token operator">=</span><span class="token string">"乒乓球"</span><span class="token operator">/</span><span class="token operator">></span>乒乓球</pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"button"</span> id<span class="token operator">=</span><span class="token string">"checkedAllBtn"</span> value<span class="token operator">=</span><span class="token string">"全　选"</span><span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="19"></td><td><pre>  <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"button"</span> id<span class="token operator">=</span><span class="token string">"checkedNoBtn"</span> value<span class="token operator">=</span><span class="token string">"全不选"</span><span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"button"</span> id<span class="token operator">=</span><span class="token string">"checkedRevBtn"</span> value<span class="token operator">=</span><span class="token string">"反　选"</span><span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="21"></td><td><pre>  <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"button"</span> id<span class="token operator">=</span><span class="token string">"sendBtn"</span> value<span class="token operator">=</span><span class="token string">"提　交"</span><span class="token operator">/</span><span class="token operator">></span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">></span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span> src<span class="token operator">=</span><span class="token string">"jquery-1.10.1.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="26"></td><td><pre>  <span class="token comment">/*</pre></td></tr><tr><td data-num="27"></td><td><pre>   功能说明:</pre></td></tr><tr><td data-num="28"></td><td><pre>   1. 点击 ' 全选 ': 选中所有爱好</pre></td></tr><tr><td data-num="29"></td><td><pre>   2. 点击 ' 全不选 ': 所有爱好都不勾选</pre></td></tr><tr><td data-num="30"></td><td><pre>   3. 点击 ' 反选 ': 改变所有爱好的勾选状态</pre></td></tr><tr><td data-num="31"></td><td><pre>   4. 点击 ' 提交 ': 提示所有勾选的爱好</pre></td></tr><tr><td data-num="32"></td><td><pre>   5. 点击 ' 全选 / 全不选 ': 选中所有爱好，或者全不选中</pre></td></tr><tr><td data-num="33"></td><td><pre>   6. 点击某个爱好时，必要时更新 ' 全选 / 全不选 ' 的选中状态</pre></td></tr><tr><td data-num="34"></td><td><pre>   */</span></pre></td></tr><tr><td data-num="35"></td><td><pre>  <span class="token keyword">var</span> $checkedAllBox <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#checkedAllBox'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>  <span class="token keyword">var</span> $items <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">':checkbox[name=items]'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre>  <span class="token comment">// 1. 点击 ' 全选 ': 选中所有爱好</span></pre></td></tr><tr><td data-num="39"></td><td><pre>  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#checkedAllBtn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    $items<span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'checked'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    $checkedAllBox<span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'checked'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre></pre></td></tr><tr><td data-num="44"></td><td><pre>  <span class="token comment">// 2. 点击 ' 全不选 ': 所有爱好都不勾选</span></pre></td></tr><tr><td data-num="45"></td><td><pre>  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#checkedNoBtn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    $items<span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'checked'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    $checkedAllBox<span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'checked'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="48"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre></pre></td></tr><tr><td data-num="50"></td><td><pre>  <span class="token comment">// 3. 点击 ' 反选 ': 改变所有爱好的勾选状态</span></pre></td></tr><tr><td data-num="51"></td><td><pre>  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#checkedRevBtn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>    $items<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>      <span class="token keyword">this</span><span class="token punctuation">.</span>checked <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>checked</pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    $checkedAllBox<span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'checked'</span><span class="token punctuation">,</span> $items<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">':not(:checked)'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token operator">===</span><span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="56"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="57"></td><td><pre></pre></td></tr><tr><td data-num="58"></td><td><pre>  <span class="token comment">//4. 点击 ' 提交 ': 提示所有勾选的爱好</span></pre></td></tr><tr><td data-num="59"></td><td><pre>  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#sendBtn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>    $items<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">':checked'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="62"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="63"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="64"></td><td><pre></pre></td></tr><tr><td data-num="65"></td><td><pre>  <span class="token comment">// 5. 点击 ' 全选 / 全不选 ': 选中所有爱好，或者全不选中</span></pre></td></tr><tr><td data-num="66"></td><td><pre>  $checkedAllBox<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>    $items<span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'checked'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>checked<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="68"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="69"></td><td><pre></pre></td></tr><tr><td data-num="70"></td><td><pre>  <span class="token comment">// 6. 点击某个爱好时，必要时更新 ' 全选 / 全不选 ' 的选中状态</span></pre></td></tr><tr><td data-num="71"></td><td><pre>  $items<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="72"></td><td><pre>    $checkedAllBox<span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'checked'</span><span class="token punctuation">,</span> $items<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">':not(:checked)'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token operator">===</span><span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="73"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="74"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></pre></td></tr><tr><td data-num="75"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span></pre></td></tr><tr><td data-num="76"></td><td><pre></pre></td></tr><tr><td data-num="77"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;代码笔记&lt;/p&gt;
    
    </summary>
    
    
      <category term="jQuery" scheme="http://yoursite.com/categories/jQuery/"/>
    
    
      <category term="jQuery笔记" scheme="http://yoursite.com/tags/jQuery%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>jQuery笔记：两个事件的区别</title>
    <link href="http://yoursite.com/2020/08/05/2020-08-05.5/"/>
    <id>http://yoursite.com/2020/08/05/2020-08-05.5/</id>
    <published>2020-08-05T12:55:32.346Z</published>
    <updated>2020-11-12T15:59:58.881Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>代码笔记</p><a id="more"></a><figure class="highlight javascript"><figcaption data-lang="javascript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">&lt;</span>html<span class="token operator">></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token operator">&lt;</span>head<span class="token operator">></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token operator">&lt;</span>title<span class="token operator">></span><span class="token number">19</span>_事件切换<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token operator">&lt;</span>style type<span class="token operator">=</span><span class="token string">"text/css"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token operator">*</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>margin<span class="token operator">:</span> <span class="token number">0</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">.</span>div1 <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>position<span class="token operator">:</span> absolute<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>width<span class="token operator">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>height<span class="token operator">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>top<span class="token operator">:</span> <span class="token number">50</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>left<span class="token operator">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>background<span class="token operator">:</span> olive<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">.</span>div2 <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>position<span class="token operator">:</span> absolute<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>width<span class="token operator">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>height<span class="token operator">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>top<span class="token operator">:</span> <span class="token number">50</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>background<span class="token operator">:</span> red<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">.</span>div3 <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>position<span class="token operator">:</span> absolute<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>width<span class="token operator">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>height<span class="token operator">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>top<span class="token operator">:</span> <span class="token number">50</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>left<span class="token operator">:</span> <span class="token number">230</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>background<span class="token operator">:</span> olive<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token punctuation">.</span>div4 <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>position<span class="token operator">:</span> absolute<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>width<span class="token operator">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>height<span class="token operator">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>top<span class="token operator">:</span> <span class="token number">50</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>background<span class="token operator">:</span> yellow<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token punctuation">.</span>divText<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>position<span class="token operator">:</span> absolute<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>top<span class="token operator">:</span> <span class="token number">330</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>left<span class="token operator">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="47"></td><td><pre></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">></span></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token operator">&lt;</span>body<span class="token operator">></span></pre></td></tr><tr><td data-num="50"></td><td><pre></pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"divText"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="52"></td><td><pre>区分鼠标的事件</pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="54"></td><td><pre></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"div1"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="56"></td><td><pre>div1<span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">.</span></pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"div2"</span><span class="token operator">></span>div2<span class="token operator">...</span><span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="59"></td><td><pre></pre></td></tr><tr><td data-num="60"></td><td><pre><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"div3"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="61"></td><td><pre>div3<span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">.</span></pre></td></tr><tr><td data-num="62"></td><td><pre><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"div4"</span><span class="token operator">></span>div4<span class="token operator">...</span><span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="63"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="64"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span></pre></td></tr><tr><td data-num="65"></td><td><pre>区别：mouseover与mouseenter</pre></td></tr><tr><td data-num="66"></td><td><pre><span class="token operator">*</span>mouseover：在移入子元素时也会触发，对应mouseout</pre></td></tr><tr><td data-num="67"></td><td><pre><span class="token operator">*</span>mouseenter：只在移入当前元素时才触发，对应mouseleave</pre></td></tr><tr><td data-num="68"></td><td><pre><span class="token function">hover</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token function">使用的就是mouseenter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token function">和mouseleave</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="69"></td><td><pre><span class="token function">区别：on</span><span class="token punctuation">(</span><span class="token string">'eventName'</span><span class="token punctuation">,</span>fun<span class="token punctuation">)</span><span class="token function">与eventName</span><span class="token punctuation">(</span>fun<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="70"></td><td><pre><span class="token operator">*</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'eventName'</span><span class="token punctuation">,</span>fun<span class="token punctuation">)</span><span class="token operator">:</span>通用，但编码麻烦</pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token operator">*</span><span class="token function">eventName</span><span class="token punctuation">(</span>fun<span class="token punctuation">)</span><span class="token operator">:</span>编码简单，但有的事件没有对应的方法</pre></td></tr><tr><td data-num="72"></td><td><pre><span class="token operator">--</span><span class="token operator">></span></pre></td></tr><tr><td data-num="73"></td><td><pre><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"js/jquery-1.10.1.js"</span> type<span class="token operator">=</span><span class="token string">"text/javascript"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></pre></td></tr><tr><td data-num="74"></td><td><pre><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="75"></td><td><pre><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.div1'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="76"></td><td><pre><span class="token punctuation">.</span><span class="token function">mouseover</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="77"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'mouseover 进入'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="78"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="79"></td><td><pre><span class="token punctuation">.</span><span class="token function">mouseout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="80"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'mouseout 离开'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="81"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="82"></td><td><pre></pre></td></tr><tr><td data-num="83"></td><td><pre><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'div3'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="84"></td><td><pre><span class="token punctuation">.</span><span class="token function">mouseenter</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="85"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'mouseenter 进入'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="86"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="87"></td><td><pre><span class="token punctuation">.</span><span class="token function">mouseleave</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="88"></td><td><pre>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'mouseleave 离开'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="89"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="90"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></pre></td></tr><tr><td data-num="91"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span></pre></td></tr><tr><td data-num="92"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;代码笔记&lt;/p&gt;
    
    </summary>
    
    
      <category term="jQuery" scheme="http://yoursite.com/categories/jQuery/"/>
    
    
      <category term="jQuery笔记" scheme="http://yoursite.com/tags/jQuery%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
</feed>
